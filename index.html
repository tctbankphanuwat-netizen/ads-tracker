```html
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdMetrics Pro</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --p:#1D4ED8;--ph:#1E40AF;--pd:#1E3A8A;--pl:#EFF6FF;--pm:#DBEAFE;
  --sec:#7C3AED;--sl:#F5F3FF;
  --ok:#059669;--okl:#ECFDF5;--okm:#D1FAE5;
  --warn:#D97706;--warnl:#FFFBEB;--warnm:#FEF3C7;
  --bad:#DC2626;--badl:#FEF2F2;--badm:#FECACA;
  --bg:#F8FAFC;--bg2:#F1F5F9;--card:#fff;
  --t1:#0F172A;--t2:#334155;--t3:#64748B;
  --b1:#E2E8F0;--b2:#CBD5E1;
  --s1:0 1px 3px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);
  --s2:0 4px 6px -1px rgba(0,0,0,.06),0 2px 4px -1px rgba(0,0,0,.04);
  --s3:0 10px 20px -3px rgba(0,0,0,.07),0 4px 6px -2px rgba(0,0,0,.04);
  --r:10px;--rl:14px;--rs:6px
}
html{font-size:14px;scroll-behavior:smooth}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Noto Sans Thai',sans-serif;background:var(--bg);color:var(--t1);line-height:1.6;min-height:100vh}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--b2);border-radius:3px}
.hdr{background:linear-gradient(135deg,#1E3A8A 0%,#1D4ED8 55%,#7C3AED 100%);position:sticky;top:0;z-index:200;box-shadow:0 2px 20px rgba(29,78,216,.28)}
.hdr-in{max-width:1440px;margin:0 auto;padding:0 24px;height:62px;display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;align-items:center;gap:11px}
.brand-ico{width:38px;height:38px;border-radius:9px;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:19px;flex-shrink:0}
.brand-name{color:#fff;font-size:16px;font-weight:800;letter-spacing:-.3px;line-height:1.2}
.brand-sub{color:rgba(255,255,255,.65);font-size:9.5px;text-transform:uppercase;letter-spacing:.8px}
.hstats{display:flex;gap:24px}
.hs{text-align:center;color:#fff}.hs-v{font-size:15px;font-weight:800;line-height:1.2}.hs-k{font-size:9px;opacity:.65;text-transform:uppercase;letter-spacing:.7px}
.nav{background:#fff;border-bottom:1px solid var(--b1);position:sticky;top:62px;z-index:199;box-shadow:var(--s1)}
.nav-in{max-width:1440px;margin:0 auto;padding:0 24px;display:flex;overflow-x:auto;scrollbar-width:none}
.nav-in::-webkit-scrollbar{display:none}
.nb{padding:0 16px;height:50px;border:none;background:none;cursor:pointer;font-size:13px;font-weight:500;color:var(--t3);display:flex;align-items:center;gap:7px;white-space:nowrap;border-bottom:2.5px solid transparent;transition:all .18s;font-family:inherit}
.nb:hover{color:var(--p);background:var(--pl)}.nb.on{color:var(--p);border-bottom-color:var(--p);font-weight:700}
.nc{min-width:17px;height:17px;padding:0 5px;background:var(--p);color:#fff;font-size:10px;font-weight:800;border-radius:100px;display:inline-flex;align-items:center;justify-content:center}
.main{max-width:1440px;margin:0 auto;padding:26px 24px}
.sec{display:none}.sec.on{display:block;animation:fu .22s ease}
@keyframes fu{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.ph{margin-bottom:26px}.ph-row{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;flex-wrap:wrap}
.pt{font-size:22px;font-weight:800;color:var(--t1);letter-spacing:-.4px;margin-bottom:5px}.pd{font-size:13px;color:var(--t3)}
.card{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);box-shadow:var(--s1);overflow:hidden}
.cb{padding:22px}.ch{padding:18px 22px 15px;border-bottom:1px solid var(--b1);display:flex;align-items:center;justify-content:space-between}
.ct{font-size:14px;font-weight:700;color:var(--t1);display:flex;align-items:center;gap:8px}.cs{font-size:12px;color:var(--t3);margin-top:2px}
.g2{display:grid;grid-template-columns:repeat(2,1fr);gap:22px}
.g3{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:15px}
.g5{display:grid;grid-template-columns:repeat(5,1fr);gap:14px}
.g6{display:grid;grid-template-columns:repeat(6,1fr);gap:12px}
.fg{margin-bottom:14px}.fg:last-child{margin-bottom:0}
.fl{display:flex;align-items:center;gap:4px;font-size:11px;font-weight:700;color:var(--t2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:5px}
.fl .req{color:var(--bad)}
.fi{width:100%;padding:9px 12px;border:1.5px solid var(--b1);border-radius:var(--r);font-size:14px;color:var(--t1);background:#fff;transition:all .18s;font-family:inherit;outline:none}
.fi:hover{border-color:var(--b2)}.fi:focus{border-color:var(--p);box-shadow:0 0 0 3px rgba(29,78,216,.08)}.fi::placeholder{color:var(--b2)}
.iw{position:relative}
.iw .ipre{position:absolute;left:11px;top:50%;transform:translateY(-50%);font-size:13px;color:var(--t3);font-weight:500;pointer-events:none}
.iw .isuf{position:absolute;right:11px;top:50%;transform:translateY(-50%);font-size:13px;color:var(--t3);font-weight:500;pointer-events:none}
.iw.p .fi{padding-left:27px}.iw.s .fi{padding-right:27px}
.fh{font-size:11px;color:var(--t3);margin-top:4px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:9px 17px;border-radius:var(--r);font-size:13px;font-weight:600;cursor:pointer;border:none;transition:all .18s;font-family:inherit;white-space:nowrap;line-height:1}
.btn:active{transform:translateY(1px)!important}
.btn-p{background:var(--p);color:#fff}.btn-p:hover{background:var(--ph);box-shadow:0 4px 14px rgba(29,78,216,.28);transform:translateY(-1px)}
.btn-ok{background:var(--ok);color:#fff}.btn-ok:hover{background:#047857;transform:translateY(-1px)}
.btn-bad{background:var(--bad);color:#fff}.btn-bad:hover{background:#B91C1C}
.btn-g{background:transparent;color:var(--t2);border:1.5px solid var(--b1)}.btn-g:hover{background:var(--bg2);border-color:var(--b2)}
.btn-ol{background:transparent;color:var(--p);border:1.5px solid var(--p)}.btn-ol:hover{background:var(--pl)}
.btn-sm{padding:6px 12px;font-size:12px;border-radius:var(--rs)}.btn-lg{padding:11px 24px;font-size:14px}
.brow{display:flex;gap:9px;flex-wrap:wrap;align-items:center}
.mc{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);padding:16px 18px;transition:all .2s;position:relative;overflow:hidden}
.mc::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--p);border-radius:var(--rl) var(--rl) 0 0}
.mc.g::before{background:var(--ok)}.mc.a::before{background:var(--warn)}.mc.v::before{background:var(--sec)}.mc.r::before{background:var(--bad)}.mc.t::before{background:#0D9488}.mc.i::before{background:#4F46E5}
.mc:hover{box-shadow:var(--s3);transform:translateY(-2px)}
.mc-lbl{font-size:11px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:7px;display:flex;align-items:center;gap:5px}
.mc-v{font-size:24px;font-weight:800;line-height:1.15;color:var(--t1);margin-bottom:4px;font-variant-numeric:tabular-nums}
.mc-v.b{color:var(--p)}.mc-v.g{color:var(--ok)}.mc-v.a{color:var(--warn)}.mc-v.v{color:var(--sec)}.mc-v.r{color:var(--bad)}.mc-v.t{color:#0D9488}.mc-v.sky{color:#0369A1}.mc-v.lime{color:#15803D}.mc-v.rose{color:#BE123C}
.mc-sub{font-size:11px;color:var(--t3)}
.mc-bg-b{background:linear-gradient(135deg,#EFF6FF,#DBEAFE);border-color:#BFDBFE}
.mc-bg-g{background:linear-gradient(135deg,#F0FDF4,#D1FAE5);border-color:#A7F3D0}
.mc-bg-a{background:linear-gradient(135deg,#FEFCE8,#FEF3C7);border-color:#FDE68A}
.mc-bg-v{background:linear-gradient(135deg,#F5F3FF,#EDE9FE);border-color:#DDD6FE}
.mc-bg-t{background:linear-gradient(135deg,#F0FDFA,#CCFBF1);border-color:#99F6E4}
.mc-bg-r{background:linear-gradient(135deg,#FFF1F2,#FFE4E6);border-color:#FECDD3}
.mc-bg-sky{background:linear-gradient(135deg,#F0F9FF,#E0F2FE);border-color:#BAE6FD}
.mc-bg-lime{background:linear-gradient(135deg,#F7FEE7,#ECFCCB);border-color:#BEF264}
.mc-bg-rose{background:linear-gradient(135deg,#FFF1F2,#FFE4E6);border-color:#FECDD3}
.rbox{background:linear-gradient(135deg,#F0F7FF,#F5F0FF);border:1px solid #C7D2FE;border-radius:var(--rl);padding:22px}
.rtitle{font-size:11px;font-weight:800;color:var(--p);text-transform:uppercase;letter-spacing:.8px;margin-bottom:16px;display:flex;align-items:center;gap:7px}
.frmbox{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r);padding:13px 15px;font-size:12px;color:var(--t2);line-height:2.1}
.frmbox code{background:#fff;color:var(--p);font-family:'Consolas','Monaco',monospace;font-size:11px;padding:2px 6px;border-radius:4px;border:1px solid var(--b1)}
.bdg{display:inline-flex;align-items:center;padding:2px 8px;border-radius:100px;font-size:11px;font-weight:700}
.bdg-b{background:#DBEAFE;color:#1E40AF}.bdg-g{background:#D1FAE5;color:#065F46}
.bdg-a{background:#FEF3C7;color:#92400E}.bdg-v{background:#EDE9FE;color:#5B21B6}
.bdg-r{background:#FFE4E6;color:#9F1239}.bdg-t{background:#CCFBF1;color:#134E4A}
.bdg-gr{background:var(--bg2);color:var(--t3)}.bdg-sky{background:#E0F2FE;color:#075985}
.bdg-lime{background:#DCFCE7;color:#166534}.bdg-rose{background:#FFE4E6;color:#9F1239}
.bdg-dark{background:#1E293B;color:#94A3B8}.bdg-green{background:#BBF7D0;color:#14532D}
.prw{margin-bottom:2px}.pri{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}
.prl{font-size:12px;font-weight:600;color:var(--t2)}.prp{font-size:12px;font-weight:700}
.prt{height:7px;background:var(--bg2);border-radius:100px;overflow:hidden}
.prf{height:100%;border-radius:100px;transition:width .55s cubic-bezier(.4,0,.2,1)}
.prf.b{background:linear-gradient(90deg,var(--p),#60A5FA)}.prf.g{background:linear-gradient(90deg,var(--ok),#34D399)}
.prf.a{background:linear-gradient(90deg,var(--warn),#FBBF24)}.prf.r{background:linear-gradient(90deg,var(--bad),#F87171)}
.prs{font-size:10px;color:var(--t3);margin-top:3px;display:flex;align-items:center;gap:4px}
.tw{overflow-x:auto;border-radius:var(--rl);border:1px solid var(--b1)}
table{width:100%;border-collapse:collapse}
thead th{padding:11px 15px;text-align:left;font-size:11px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;background:var(--bg2);border-bottom:1px solid var(--b1);white-space:nowrap}
tbody td{padding:13px 15px;border-bottom:1px solid var(--b1);color:var(--t1);vertical-align:middle}
tbody tr:last-child td{border-bottom:none}
tbody tr:hover td{background:var(--pl)}
.tn{font-weight:700;font-size:13px}.tnm{font-size:11px;color:var(--t3);margin-top:2px}
.tv{font-weight:600;color:var(--p);font-variant-numeric:tabular-nums;font-size:13px}
.str{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:22px}
.st{padding:7px 15px;border-radius:100px;border:1.5px solid var(--b1);background:#fff;font-size:12px;font-weight:600;color:var(--t3);cursor:pointer;transition:all .18s;font-family:inherit}
.st:hover{border-color:var(--p);color:var(--p);background:var(--pl)}.st.on{background:var(--p);color:#fff;border-color:var(--p)}
.dv{height:1px;background:var(--b1);margin:18px 0}
.emp{text-align:center;padding:60px 20px;display:flex;flex-direction:column;align-items:center;gap:11px}
.emp-i{font-size:48px;line-height:1}.emp-t{font-size:16px;font-weight:700;color:var(--t2)}.emp-d{font-size:13px;color:var(--t3);max-width:350px;line-height:1.7}
.tip{position:relative;display:inline-flex;align-items:center}
.tip-i{width:14px;height:14px;background:var(--b1);border-radius:50%;font-size:9px;color:var(--t3);cursor:help;display:inline-flex;align-items:center;justify-content:center;margin-left:4px;flex-shrink:0;font-style:italic;font-weight:700}
.tip-t{display:none;position:absolute;bottom:130%;left:50%;transform:translateX(-50%);background:#0F172A;color:#fff;font-size:11px;padding:7px 11px;border-radius:7px;min-width:170px;max-width:230px;text-align:center;z-index:500;line-height:1.5;pointer-events:none;font-weight:400;box-shadow:0 4px 12px rgba(0,0,0,.2)}
.tip-t::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border:5px solid transparent;border-top-color:#0F172A}
.tip:hover .tip-t{display:block}
.kpic{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);margin-bottom:18px;box-shadow:var(--s1);overflow:hidden}
.kpih{background:linear-gradient(135deg,#1E3A8A,#1D4ED8 55%,#7C3AED);padding:17px 22px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px}
.kpin{font-size:15px;font-weight:800;color:#fff}.kpim{font-size:11px;color:rgba(255,255,255,.7);margin-top:2px}
.kpib{padding:18px 22px}
.kmi{background:var(--bg);border:1px solid var(--b1);border-radius:var(--r);padding:14px}
.kmit{font-size:10px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:10px}
.kmi-g{display:grid;grid-template-columns:1fr 1fr;gap:7px;margin-bottom:8px}
.kmi-g .fg{margin:0}.kmi-g .fl{font-size:9px;letter-spacing:.3px}.kmi-g .fi{padding:6px 10px;font-size:12px}
.kpiovr{border-radius:var(--r);padding:13px 16px;display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap;margin-top:14px;border:1px solid}
.kpiovr.ok{background:var(--okl);border-color:#A7F3D0}.kpiovr.warn{background:var(--warnl);border-color:#FDE68A}.kpiovr.bad{background:var(--badl);border-color:#FECACA}
.kpotr{font-size:13px;font-weight:700}
.kpiovr.ok .kpotr{color:var(--ok)}.kpiovr.warn .kpotr{color:var(--warn)}.kpiovr.bad .kpotr{color:var(--bad)}
.chc{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);padding:20px;box-shadow:var(--s1)}
.cht{font-size:14px;font-weight:700;color:var(--t1);margin-bottom:3px}.chs{font-size:11px;color:var(--t3);margin-bottom:16px}
.chw{position:relative;height:230px}
.sstrip{background:linear-gradient(135deg,var(--pd),var(--p) 50%,var(--sec));border-radius:var(--rl);padding:18px 26px;display:flex;align-items:center;gap:24px;flex-wrap:wrap;margin-bottom:22px}
.ssi{color:#fff;flex:1;min-width:90px}.ssv{font-size:21px;font-weight:800;line-height:1.2}.ssk{font-size:9px;opacity:.7;text-transform:uppercase;letter-spacing:.7px}
.ssdv{width:1px;height:36px;background:rgba(255,255,255,.2)}
/* Platform header styles */
.ph-gg{background:linear-gradient(135deg,#1A73E8,#34A853)}
.ph-tt{background:linear-gradient(135deg,#010101,#FE2C55)}
.ph-ln{background:linear-gradient(135deg,#00B900,#00C300)}
#toasts{position:fixed;bottom:22px;right:22px;z-index:9999;display:flex;flex-direction:column-reverse;gap:8px;pointer-events:none}
.tst{padding:10px 15px;border-radius:10px;font-size:13px;font-weight:600;box-shadow:0 4px 16px rgba(0,0,0,.12);max-width:300px;animation:si .22s ease;pointer-events:auto;display:flex;align-items:center;gap:8px}
.tst.ok{background:#F0FDF4;border:1px solid #BBF7D0;color:#065F46}
.tst.warn{background:var(--warnl);border:1px solid #FDE68A;color:#92400E}
.tst.bad{background:var(--badl);border:1px solid #FECACA;color:#991B1B}
@keyframes si{from{opacity:0;transform:translateX(18px)}to{opacity:1;transform:translateX(0)}}
.mb3{margin-bottom:12px}.mb4{margin-bottom:16px}.mb6{margin-bottom:24px}.mt4{margin-top:16px}.mt6{margin-top:24px}
@media(max-width:1100px){.g5{grid-template-columns:repeat(3,1fr)}}
@media(max-width:900px){.g4{grid-template-columns:repeat(2,1fr)}.g6{grid-template-columns:repeat(3,1fr)}}
@media(max-width:700px){
  .hstats{display:none}.main{padding:16px}
  .g2,.g3,.g4,.g5,.g6{grid-template-columns:1fr}
  .pt{font-size:19px}.sstrip{flex-direction:column;padding:16px 18px}
  .ssdv{width:36px;height:1px}.mc-v{font-size:20px}
  .kpib{padding:14px 16px}.kpih{padding:14px 16px}
  .kmi-g{grid-template-columns:1fr}
}
@media(max-width:480px){.cb{padding:15px}.ch{padding:14px 15px 12px}}
</style>
</head>
<body>
<div id="toasts"></div>

<!-- HEADER -->
<header class="hdr">
  <div class="hdr-in">
    <div class="brand">
      <div class="brand-ico">ğŸ“Š</div>
      <div><div class="brand-name">AdMetrics Pro</div><div class="brand-sub">Multi-Platform Performance Calculator</div></div>
    </div>
    <div class="hstats">
      <div class="hs"><div class="hs-v" id="hs1">0</div><div class="hs-k">Campaigns</div></div>
      <div class="hs"><div class="hs-v" id="hs2">à¸¿0</div><div class="hs-k">Total Budget</div></div>
      <div class="hs"><div class="hs-v" id="hs3">â€”</div><div class="hs-k">Avg ROAS</div></div>
      <div class="hs"><div class="hs-v" id="hs4">0</div><div class="hs-k">Conversions</div></div>
    </div>
  </div>
</header>

<!-- NAV -->
<nav class="nav">
  <div class="nav-in">
    <button class="nb on" onclick="goTab('calc')">ğŸ§® Media Buying</button>
    <button class="nb" onclick="goTab('fb')">ğŸ“˜ Facebook</button>
    <button class="nb" onclick="goTab('gg')">ğŸ” Google</button>
    <button class="nb" onclick="goTab('tt')">ğŸµ TikTok</button>
    <button class="nb" onclick="goTab('ln')">ğŸ’š LINE</button>
    <button class="nb" onclick="goTab('camps')">ğŸ“‹ Campaigns <span class="nc" id="nc">0</span></button>
    <button class="nb" onclick="goTab('kpi')">ğŸ¯ KPI Tracking</button>
    <button class="nb" onclick="goTab('dash')">ğŸ“ˆ Dashboard</button>
  </div>
</nav>

<main class="main">

<!-- ===== MEDIA BUYING ===== -->
<section id="t-calc" class="sec on">
  <div class="ph"><div class="pt">Media Buying Calculator</div><div class="pd">à¸„à¸³à¸™à¸§à¸“ Impressions, Clicks, Conversions, CPA à¹à¸¥à¸° ROAS à¸ˆà¸²à¸à¸‡à¸šà¸›à¸£à¸°à¸¡à¸²à¸“à¹à¸„à¸¡à¹€à¸›à¸</div></div>
  <div class="g2">
    <div>
      <div class="card">
        <div class="ch"><div><div class="ct">âš™ï¸ Campaign Setup</div><div class="cs">à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸„à¸¡à¹€à¸›à¸à¹€à¸à¸·à¹ˆà¸­à¸„à¸³à¸™à¸§à¸“à¹à¸¥à¸°à¸šà¸±à¸™à¸—à¸¶à¸</div></div></div>
        <div class="cb">
          <div class="fg"><label class="fl">Campaign Name <span class="req">*</span></label><input class="fi" id="cn" type="text" placeholder="e.g. Q2 Brand Campaign 2025"></div>
          <div class="g2">
            <div class="fg"><label class="fl">Budget <span class="tip"><span class="tip-i">i</span><span class="tip-t">à¸‡à¸šà¸›à¸£à¸°à¸¡à¸²à¸“à¸£à¸§à¸¡à¸—à¸±à¹‰à¸‡à¹à¸„à¸¡à¹€à¸›à¸</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="cb2" type="number" min="0" placeholder="50,000" oninput="calcM()"></div></div>
            <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">Cost per 1,000 Impressions</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="ccpm" type="number" min="0" placeholder="80" oninput="calcM()"></div></div>
            <div class="fg"><label class="fl">CPC <span class="tip"><span class="tip-i">i</span><span class="tip-t">Cost per Click</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="ccpc" type="number" min="0" step=".01" placeholder="5.00" oninput="calcM()"></div></div>
            <div class="fg"><label class="fl">CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">Conversion Rate â€” % à¸„à¸™à¸—à¸µà¹ˆà¸„à¸¥à¸´à¸à¹à¸¥à¹‰à¸§à¸‹à¸·à¹‰à¸­</span></span></label><div class="iw s"><input class="fi" id="ccvr" type="number" min="0" max="100" step=".01" placeholder="2.50" oninput="calcM()"><span class="isuf">%</span></div></div>
          </div>
          <div class="fg"><label class="fl">Product Price / Unit <span class="tip"><span class="tip-i">i</span><span class="tip-t">à¸£à¸²à¸„à¸²à¸‚à¸²à¸¢à¹€à¸‰à¸¥à¸µà¹ˆà¸¢à¸•à¹ˆà¸­ 1 à¸Šà¸´à¹‰à¸™</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="cprc" type="number" min="0" placeholder="990" oninput="calcM()"></div></div>
          <div class="frmbox mt4">ğŸ“ <strong style="color:var(--p)">Formulas:</strong><br>
            <code>Impr = (BudgetÃ·CPM)Ã—1000</code> | <code>Clicks = BudgetÃ·CPC</code><br>
            <code>Conv = ClicksÃ—CVR%</code> | <code>CPA = BudgetÃ·Conv</code> | <code>ROAS = RevenueÃ·Budget</code>
          </div>
          <div class="brow mt4"><button class="btn btn-p btn-lg" onclick="saveM()">ğŸ’¾ Save Campaign</button><button class="btn btn-g" onclick="clearM()">ğŸ”„ Reset</button></div>
        </div>
      </div>
    </div>
    <div>
      <div class="rbox">
        <div class="rtitle">âœ¨ Calculated Results</div>
        <div class="g2 mb4">
          <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="ri">â€”</div><div class="mc-sub">à¸à¸²à¸£à¹à¸ªà¸”à¸‡à¸œà¸¥</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v g" id="rc">â€”</div><div class="mc-sub">à¸ˆà¸³à¸™à¸§à¸™à¸„à¸¥à¸´à¸</div></div>
          <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v v" id="rv">â€”</div><div class="mc-sub">à¸ˆà¸³à¸™à¸§à¸™ Conversion</div></div>
          <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="rpa">â€”</div><div class="mc-sub">Cost per Acquisition</div></div>
        </div>
        <div class="g3 mb4">
          <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="rrev">â€”</div><div class="mc-sub">à¸£à¸²à¸¢à¹„à¸”à¹‰à¸„à¸²à¸”à¸à¸²à¸£à¸“à¹Œ</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="rroas">â€”</div><div class="mc-sub">Return on Ad Spend</div></div>
          <div class="mc" id="rpc2"><div class="mc-lbl">ğŸ’µ Gross Profit</div><div class="mc-v" id="rpro">â€”</div><div class="mc-sub">Revenue âˆ’ Budget</div></div>
        </div>
        <div class="g3">
          <div style="background:#fff;border:1px solid var(--b1);border-radius:var(--r);padding:12px;text-align:center"><div class="mc-lbl" style="justify-content:center;margin-bottom:5px">CTR</div><div style="font-size:19px;font-weight:800;color:var(--p)" id="rctr">â€”</div><div class="mc-sub">Click-Through Rate</div></div>
          <div style="background:#fff;border:1px solid var(--b1);border-radius:var(--r);padding:12px;text-align:center"><div class="mc-lbl" style="justify-content:center;margin-bottom:5px">eCPM</div><div style="font-size:19px;font-weight:800;color:var(--sec)" id="recpm">â€”</div><div class="mc-sub">Effective CPM</div></div>
          <div style="background:#fff;border:1px solid var(--b1);border-radius:var(--r);padding:12px;text-align:center"><div class="mc-lbl" style="justify-content:center;margin-bottom:5px">Rev/Conv</div><div style="font-size:19px;font-weight:800;color:var(--ok)" id="rrpc">â€”</div><div class="mc-sub">Revenue per Conv.</div></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ===== FACEBOOK ===== -->
<section id="t-fb" class="sec">
  <div class="ph"><div class="pt">Facebook Ads Calculator</div><div class="pd">à¸„à¸³à¸™à¸§à¸“à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¹à¸„à¸¡à¹€à¸›à¸ Facebook à¹à¸¢à¸à¸•à¸²à¸¡ Objective</div></div>
  <div class="str">
    <button class="st on" onclick="fbTab('like')">ğŸ‘ Page Like</button>
    <button class="st" onclick="fbTab('eng')">ğŸ’¬ Engagement</button>
    <button class="st" onclick="fbTab('lead')">ğŸ“‹ Lead Ads</button>
    <button class="st" onclick="fbTab('vid')">ğŸ¬ Video View</button>
  </div>
  <!-- Page Like -->
  <div id="fb-like" class="fb-p"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ‘ Page Like Ads</div><div class="cs">à¹€à¸à¸´à¹ˆà¸¡ Page Followers</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fln" type="text" placeholder="Page Like Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="flb" type="number" min="0" placeholder="10,000" oninput="calcLike()"></div></div>
        <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. à¸¿40â€“80</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="flcpm" type="number" min="0" placeholder="50" oninput="calcLike()"></div></div>
        <div class="fg"><label class="fl">Cost per Like <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. à¸¿1â€“5</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="flcpl" type="number" min="0" step=".1" placeholder="2.50" oninput="calcLike()"></div></div>
        <div class="fg"><label class="fl">Like Rate %</label><div class="iw s"><input class="fi" id="flr" type="number" min="0" max="100" step=".1" placeholder="1.5" oninput="calcLike()"><span class="isuf">%</span></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_page_like','fln')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['flb','flcpm','flcpl','flr'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox"><div class="rtitle">ğŸ“Š Page Like Results</div><div class="g2">
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="flri">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ‘¥ Est. Reach</div><div class="mc-v t" id="flrr">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ‘ Page Likes</div><div class="mc-v g" id="flrl">â€”</div></div>
      <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° Actual CPL</div><div class="mc-v a" id="flrc">â€”</div></div>
    </div></div>
  </div></div>
  <!-- Engagement -->
  <div id="fb-eng" class="fb-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ’¬ Engagement Ads</div><div class="cs">Post Likes, Comments, Shares</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fen" type="text" placeholder="Engagement Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="feb" type="number" min="0" placeholder="20,000" oninput="calcEng()"></div></div>
        <div class="fg"><label class="fl">CPM</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fecpm" type="number" min="0" placeholder="60" oninput="calcEng()"></div></div>
        <div class="fg"><label class="fl">CPE <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. à¸¿0.5â€“3</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fecpe" type="number" min="0" step=".1" placeholder="1.50" oninput="calcEng()"></div></div>
        <div class="fg"><label class="fl">Engagement Rate</label><div class="iw s"><input class="fi" id="fer" type="number" min="0" max="100" step=".1" placeholder="3.0" oninput="calcEng()"><span class="isuf">%</span></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_engagement','fen')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['feb','fecpm','fecpe','fer'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox"><div class="rtitle">ğŸ“Š Engagement Results</div><div class="g2">
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="feri">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ‘¥ Reach</div><div class="mc-v t" id="ferr">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ’¬ Engagements</div><div class="mc-v g" id="fere">â€”</div></div>
      <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° Actual CPE</div><div class="mc-v a" id="ferc">â€”</div></div>
    </div></div>
  </div></div>
  <!-- Lead -->
  <div id="fb-lead" class="fb-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ“‹ Lead Ads</div><div class="cs">Facebook Instant Lead Form</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fldn" type="text" placeholder="Lead Gen Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fldb" type="number" min="0" placeholder="30,000" oninput="calcLead()"></div></div>
        <div class="fg"><label class="fl">CPM</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fldcpm" type="number" min="0" placeholder="80" oninput="calcLead()"></div></div>
        <div class="fg"><label class="fl">CTR <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 0.5â€“2.5%</span></span></label><div class="iw s"><input class="fi" id="fldctr" type="number" min="0" step=".1" placeholder="1.5" oninput="calcLead()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Form Fill Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 10â€“30%</span></span></label><div class="iw s"><input class="fi" id="fldf" type="number" min="0" step="1" placeholder="20" oninput="calcLead()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fldp" type="number" min="0" placeholder="2,500" oninput="calcLead()"></div></div>
        <div class="fg"><label class="fl">Lead â†’ Sale CVR</label><div class="iw s"><input class="fi" id="fldcvr" type="number" min="0" step="1" placeholder="15" oninput="calcLead()"><span class="isuf">%</span></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_lead','fldn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['fldb','fldcpm','fldctr','fldf','fldp','fldcvr'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox"><div class="rtitle">ğŸ“Š Lead Gen Results</div><div class="g2">
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="fldri">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v t" id="fldrc">â€”</div></div>
      <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ“‹ Leads</div><div class="mc-v v" id="fldrl">â€”</div></div>
      <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° Cost/Lead</div><div class="mc-v a" id="fldra">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ¯ Sales</div><div class="mc-v g" id="fldrs">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v t" id="fldrr">â€”</div></div>
    </div></div>
  </div></div>
  <!-- Video -->
  <div id="fb-vid" class="fb-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ¬ Video View Ads</div><div class="cs">ThruPlay / 2-Second Video</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fvn" type="text" placeholder="Video Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fvb" type="number" min="0" placeholder="15,000" oninput="calcVid()"></div></div>
        <div class="fg"><label class="fl">CPM</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fvcpm" type="number" min="0" placeholder="55" oninput="calcVid()"></div></div>
        <div class="fg"><label class="fl">2-Sec View Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 20â€“50%</span></span></label><div class="iw s"><input class="fi" id="fv2" type="number" min="0" step="1" placeholder="35" oninput="calcVid()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">ThruPlay Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 5â€“15%</span></span></label><div class="iw s"><input class="fi" id="fvt" type="number" min="0" step="1" placeholder="10" oninput="calcVid()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CPV Target</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="fvcpv" type="number" min="0" step=".1" placeholder="1.00" oninput="calcVid()"></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_video','fvn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['fvb','fvcpm','fv2','fvt','fvcpv'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox"><div class="rtitle">ğŸ“Š Video Results</div><div class="g2">
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="fvri">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">â–¶ï¸ 2-Sec Views</div><div class="mc-v g" id="fvr2">â€”</div></div>
      <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ“º ThruPlays</div><div class="mc-v v" id="fvrt">â€”</div></div>
      <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° Cost/ThruPlay</div><div class="mc-v a" id="fvrc">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“Š View Rate</div><div class="mc-v t" id="fvrr">â€”</div></div>
      <div class="mc mc-bg-r"><div class="mc-lbl">ğŸ’µ eCPM</div><div class="mc-v r" id="fvre">â€”</div></div>
    </div></div>
  </div></div>
</section>

<!-- ===== GOOGLE ADS ===== -->
<section id="t-gg" class="sec">
  <div class="ph">
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:42px;height:42px;border-radius:10px;background:linear-gradient(135deg,#4285F4,#34A853);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">ğŸ”</div>
      <div><div class="pt" style="margin:0">Google Ads Calculator</div><div class="pd">Search, Display/GDN à¹à¸¥à¸° YouTube Ads</div></div>
    </div>
  </div>
  <div class="str">
    <button class="st on" onclick="ggTab('search')">ğŸ” Search</button>
    <button class="st" onclick="ggTab('display')">ğŸ–¥ï¸ Display / GDN</button>
    <button class="st" onclick="ggTab('youtube')">â–¶ï¸ YouTube</button>
  </div>

  <!-- Search -->
  <div id="gg-search" class="gg-p"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ” Search Campaign</div><div class="cs">Keyword-based CPC bidding</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="gsn" type="text" placeholder="Brand Search Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gsb" type="number" min="0" placeholder="30,000" oninput="calcGS()"></div></div>
        <div class="fg"><label class="fl">Max CPC <span class="tip"><span class="tip-i">i</span><span class="tip-t">à¸£à¸²à¸„à¸²à¸›à¸£à¸°à¸¡à¸¹à¸¥à¸ªà¸¹à¸‡à¸ªà¸¸à¸”à¸•à¹ˆà¸­à¸„à¸¥à¸´à¸ avg. à¸¿5â€“50</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gscpc" type="number" min="0" step=".1" placeholder="15" oninput="calcGS()"></div></div>
        <div class="fg"><label class="fl">Expected CTR <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. Search CTR 2â€“8%</span></span></label><div class="iw s"><input class="fi" id="gsctr" type="number" min="0" max="100" step=".1" placeholder="4.0" oninput="calcGS()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. Search CVR 3â€“5%</span></span></label><div class="iw s"><input class="fi" id="gscvr" type="number" min="0" max="100" step=".1" placeholder="3.5" oninput="calcGS()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Quality Score <span class="tip"><span class="tip-i">i</span><span class="tip-t">1â€“10: à¸ªà¹ˆà¸‡à¸œà¸¥à¸•à¹ˆà¸­ Ad Rank à¹à¸¥à¸° CPC à¸ˆà¸£à¸´à¸‡</span></span></label><input class="fi" id="gsqs" type="number" min="1" max="10" step="1" placeholder="7" oninput="calcGS()"></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gsprc" type="number" min="0" placeholder="1,500" oninput="calcGS()"></div></div>
      </div>
      <div class="frmbox mt4">
        ğŸ“ <strong style="color:var(--p)">Search Formula:</strong><br>
        <code>Clicks = Budget Ã· Avg.CPC</code> | <code>Impressions = Clicks Ã· CTR%</code><br>
        <code>Adj.CPC = Max.CPC Ã— (10Ã·QS)</code> | <code>Conversions = Clicks Ã— CVR%</code>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveGG('gg_search','gsn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['gsb','gscpc','gsctr','gscvr','gsqs','gsprc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox"><div class="rtitle" style="color:#1A73E8">ğŸ” Search Results</div><div class="g2">
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="gsr-imp">â€”</div><div class="mc-sub">Estimated reach</div></div>
      <div class="mc mc-bg-sky"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v sky" id="gsr-clk">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v g" id="gsr-con">â€”</div></div>
      <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="gsr-cpa">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="gsr-rev">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="gsr-roas">â€”</div></div>
      <div class="mc mc-bg-sky"><div class="mc-lbl">ğŸ’µ Adj. CPC</div><div class="mc-v sky" id="gsr-acpc">â€”</div><div class="mc-sub">After Quality Score</div></div>
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ“Š CTR</div><div class="mc-v b" id="gsr-ctr">â€”</div></div>
    </div></div>
  </div></div>

  <!-- Display -->
  <div id="gg-display" class="gg-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ–¥ï¸ Display / GDN</div><div class="cs">Google Display Network â€” Banner Ads</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="gdn" type="text" placeholder="Display Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gdb" type="number" min="0" placeholder="20,000" oninput="calcGD()"></div></div>
        <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">GDN avg. à¸¿15â€“50</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gdcpm" type="number" min="0" placeholder="30" oninput="calcGD()"></div></div>
        <div class="fg"><label class="fl">CTR <span class="tip"><span class="tip-i">i</span><span class="tip-t">Display avg. 0.1â€“0.5%</span></span></label><div class="iw s"><input class="fi" id="gdctr" type="number" min="0" step=".01" placeholder="0.3" oninput="calcGD()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 0.5â€“2%</span></span></label><div class="iw s"><input class="fi" id="gdcvr" type="number" min="0" step=".1" placeholder="1.5" oninput="calcGD()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Frequency Cap <span class="tip"><span class="tip-i">i</span><span class="tip-t">à¸ˆà¸³à¸™à¸§à¸™à¸„à¸£à¸±à¹‰à¸‡à¸ªà¸¹à¸‡à¸ªà¸¸à¸”à¸—à¸µà¹ˆà¹à¸ªà¸”à¸‡à¸•à¹ˆà¸­à¸„à¸™/à¸§à¸±à¸™</span></span></label><input class="fi" id="gdfreq" type="number" min="1" step="1" placeholder="3" oninput="calcGD()"></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gdprc" type="number" min="0" placeholder="990" oninput="calcGD()"></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveGG('gg_display','gdn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['gdb','gdcpm','gdctr','gdcvr','gdfreq','gdprc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox"><div class="rtitle" style="color:#1A73E8">ğŸ–¥ï¸ Display Results</div><div class="g2">
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="gdr-imp">â€”</div></div>
      <div class="mc mc-bg-sky"><div class="mc-lbl">ğŸ‘¥ Est. Unique Reach</div><div class="mc-v sky" id="gdr-reach">â€”</div><div class="mc-sub">Impressions Ã· Frequency</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v g" id="gdr-clk">â€”</div></div>
      <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v v" id="gdr-con">â€”</div></div>
      <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="gdr-cpa">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="gdr-rev">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="gdr-roas">â€”</div></div>
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ’µ eCPC</div><div class="mc-v b" id="gdr-ecpc">â€”</div></div>
    </div></div>
  </div></div>

  <!-- YouTube -->
  <div id="gg-youtube" class="gg-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">â–¶ï¸ YouTube Ads</div><div class="cs">TrueView In-Stream / In-Feed</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="gyn" type="text" placeholder="YouTube Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gyb" type="number" min="0" placeholder="25,000" oninput="calcGY()"></div></div>
        <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">YouTube avg. à¸¿40â€“120</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gycpm" type="number" min="0" placeholder="70" oninput="calcGY()"></div></div>
        <div class="fg"><label class="fl">View Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆà¸”à¸¹à¸ˆà¸™à¸ˆà¸šà¸«à¸£à¸·à¸­ â‰¥30 à¸§à¸´ avg. 15â€“40%</span></span></label><div class="iw s"><input class="fi" id="gyvr" type="number" min="0" max="100" step="1" placeholder="25" oninput="calcGY()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Click Rate (from views) <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆà¸”à¸¹à¹à¸¥à¹‰à¸§à¸„à¸¥à¸´à¸ avg. 0.5â€“2%</span></span></label><div class="iw s"><input class="fi" id="gyctr" type="number" min="0" max="100" step=".1" placeholder="1.0" oninput="calcGY()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CVR</label><div class="iw s"><input class="fi" id="gycvr" type="number" min="0" max="100" step=".1" placeholder="2.5" oninput="calcGY()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="gyprc" type="number" min="0" placeholder="1,500" oninput="calcGY()"></div></div>
      </div>
      <div class="frmbox mt4">
        ğŸ“ <code>Impressions=(BudgetÃ·CPM)Ã—1000</code> | <code>Views=ImprÃ—ViewRate%</code><br>
        <code>CPV=BudgetÃ·Views</code> | <code>Clicks=ViewsÃ—CTR%</code> | <code>Conv=ClicksÃ—CVR%</code>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveGG('gg_youtube','gyn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['gyb','gycpm','gyvr','gyctr','gycvr','gyprc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox"><div class="rtitle" style="color:#FF0000">â–¶ï¸ YouTube Results</div><div class="g2">
      <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="gyr-imp">â€”</div></div>
      <div class="mc mc-bg-r"><div class="mc-lbl">â–¶ï¸ Views (TrueView)</div><div class="mc-v r" id="gyr-view">â€”</div></div>
      <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPV (Actual)</div><div class="mc-v a" id="gyr-cpv">â€”</div></div>
      <div class="mc mc-bg-sky"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v sky" id="gyr-clk">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v g" id="gyr-con">â€”</div></div>
      <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="gyr-rev">â€”</div></div>
      <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="gyr-roas">â€”</div></div>
      <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ“Š View Rate</div><div class="mc-v v" id="gyr-vr">â€”</div></div>
    </div></div>
  </div></div>
</section>

<!-- ===== TIKTOK ADS ===== -->
<section id="t-tt" class="sec">
  <div class="ph">
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:42px;height:42px;border-radius:10px;background:linear-gradient(135deg,#010101,#FE2C55);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">ğŸµ</div>
      <div><div class="pt" style="margin:0">TikTok Ads Calculator</div><div class="pd">In-Feed, TopView à¹à¸¥à¸° Spark Ads</div></div>
    </div>
  </div>
  <div class="str">
    <button class="st on" onclick="ttTab('infeed')">ğŸ“± In-Feed Ads</button>
    <button class="st" onclick="ttTab('topview')">ğŸ‘ï¸ TopView</button>
    <button class="st" onclick="ttTab('spark')">âœ¨ Spark Ads</button>
  </div>

  <!-- In-Feed -->
  <div id="tt-infeed" class="tt-p"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ“± In-Feed Ads</div><div class="cs">à¹‚à¸†à¸©à¸“à¸²à¹ƒà¸™à¸«à¸™à¹‰à¸² For You Page</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="tin" type="text" placeholder="TikTok In-Feed Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tib" type="number" min="0" placeholder="20,000" oninput="calcTTI()"></div></div>
        <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">TikTok TH avg. à¸¿60â€“150</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="ticpm" type="number" min="0" placeholder="90" oninput="calcTTI()"></div></div>
        <div class="fg"><label class="fl">CTR <span class="tip"><span class="tip-i">i</span><span class="tip-t">TikTok In-Feed avg. 1â€“3%</span></span></label><div class="iw s"><input class="fi" id="titr" type="number" min="0" step=".1" placeholder="1.8" oninput="calcTTI()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 1â€“4%</span></span></label><div class="iw s"><input class="fi" id="ticvr" type="number" min="0" step=".1" placeholder="2.0" oninput="calcTTI()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Video View Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆà¸”à¸¹ VDO â‰¥ 6 à¸§à¸´ avg. 20â€“45%</span></span></label><div class="iw s"><input class="fi" id="tivr" type="number" min="0" step="1" placeholder="30" oninput="calcTTI()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tiprc" type="number" min="0" placeholder="590" oninput="calcTTI()"></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveTT('tt_infeed','tin')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['tib','ticpm','titr','ticvr','tivr','tiprc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox" style="background:linear-gradient(135deg,#0D0D0D08,#FE2C5508);border-color:#FE2C5530">
      <div class="rtitle" style="color:#FE2C55">ğŸ“± In-Feed Results</div><div class="g2">
        <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="tir-imp">â€”</div></div>
        <div class="mc mc-bg-r"><div class="mc-lbl">â–¶ï¸ Video Views</div><div class="mc-v r" id="tir-vv">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v g" id="tir-clk">â€”</div></div>
        <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v v" id="tir-con">â€”</div></div>
        <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="tir-cpa">â€”</div></div>
        <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="tir-rev">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="tir-roas">â€”</div></div>
        <div class="mc mc-bg-r"><div class="mc-lbl">ğŸ’µ eCPM</div><div class="mc-v r" id="tir-ecpm">â€”</div></div>
      </div>
    </div>
  </div></div>

  <!-- TopView -->
  <div id="tt-topview" class="tt-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ‘ï¸ TopView Ads</div><div class="cs">à¹‚à¸†à¸©à¸“à¸²à¹à¸£à¸à¸—à¸µà¹ˆà¹€à¸«à¹‡à¸™à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸›à¸´à¸” TikTok</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="tvn" type="text" placeholder="TopView Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tvb" type="number" min="0" placeholder="100,000" oninput="calcTTV()"></div></div>
        <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">TopView premium avg. à¸¿300â€“600</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tvcpm" type="number" min="0" placeholder="400" oninput="calcTTV()"></div></div>
        <div class="fg"><label class="fl">Full View Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆà¸”à¸¹à¸„à¸£à¸šà¸—à¸±à¹‰à¸‡ VDO avg. 50â€“80%</span></span></label><div class="iw s"><input class="fi" id="tvfvr" type="number" min="0" step="1" placeholder="65" oninput="calcTTV()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CTR <span class="tip"><span class="tip-i">i</span><span class="tip-t">TopView avg. 1.5â€“5%</span></span></label><div class="iw s"><input class="fi" id="tvctr" type="number" min="0" step=".1" placeholder="3.0" oninput="calcTTV()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CVR</label><div class="iw s"><input class="fi" id="tvcvr" type="number" min="0" step=".1" placeholder="2.5" oninput="calcTTV()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tvprc" type="number" min="0" placeholder="990" oninput="calcTTV()"></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveTT('tt_topview','tvn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['tvb','tvcpm','tvfvr','tvctr','tvcvr','tvprc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox" style="background:linear-gradient(135deg,#0D0D0D08,#FE2C5508);border-color:#FE2C5530">
      <div class="rtitle" style="color:#FE2C55">ğŸ‘ï¸ TopView Results</div><div class="g2">
        <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="tvr-imp">â€”</div></div>
        <div class="mc mc-bg-r"><div class="mc-lbl">ğŸ¬ Full Views</div><div class="mc-v r" id="tvr-fv">â€”</div></div>
        <div class="mc mc-bg-sky"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v sky" id="tvr-clk">â€”</div></div>
        <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v v" id="tvr-con">â€”</div></div>
        <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="tvr-cpa">â€”</div></div>
        <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="tvr-rev">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="tvr-roas">â€”</div></div>
        <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ“Š Avg.CPV</div><div class="mc-v b" id="tvr-cpv">â€”</div></div>
      </div>
    </div>
  </div></div>

  <!-- Spark Ads -->
  <div id="tt-spark" class="tt-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">âœ¨ Spark Ads</div><div class="cs">Boost Organic Content</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="tsn" type="text" placeholder="Spark Ads Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tsb" type="number" min="0" placeholder="15,000" oninput="calcTTS()"></div></div>
        <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. à¸¿60â€“120</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tscpm" type="number" min="0" placeholder="75" oninput="calcTTS()"></div></div>
        <div class="fg"><label class="fl">CPE <span class="tip"><span class="tip-i">i</span><span class="tip-t">Cost per Engagement avg. à¸¿0.3â€“2</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="tscpe" type="number" min="0" step=".1" placeholder="1.0" oninput="calcTTS()"></div></div>
        <div class="fg"><label class="fl">Engagement Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 3â€“8% (Like/Comment/Share/Save)</span></span></label><div class="iw s"><input class="fi" id="tser" type="number" min="0" step=".1" placeholder="5.0" oninput="calcTTS()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Profile Visit Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆà¸„à¸¥à¸´à¸à¸”à¸¹ Profile à¸ˆà¸²à¸ Engagement avg. 8â€“15%</span></span></label><div class="iw s"><input class="fi" id="tspvr" type="number" min="0" step=".1" placeholder="10" oninput="calcTTS()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Follow Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆ Follow à¸«à¸¥à¸±à¸‡à¹€à¸‚à¹‰à¸² Profile avg. 5â€“15%</span></span></label><div class="iw s"><input class="fi" id="tsfr" type="number" min="0" step=".1" placeholder="8.0" oninput="calcTTS()"><span class="isuf">%</span></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveTT('tt_spark','tsn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['tsb','tscpm','tscpe','tser','tspvr','tsfr'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox" style="background:linear-gradient(135deg,#0D0D0D08,#FE2C5508);border-color:#FE2C5530">
      <div class="rtitle" style="color:#FE2C55">âœ¨ Spark Ads Results</div><div class="g2">
        <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="tsr-imp">â€”</div></div>
        <div class="mc mc-bg-r"><div class="mc-lbl">ğŸ’¬ Engagements</div><div class="mc-v r" id="tsr-eng">â€”</div></div>
        <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° Actual CPE</div><div class="mc-v a" id="tsr-cpe">â€”</div></div>
        <div class="mc mc-bg-sky"><div class="mc-lbl">ğŸ‘¤ Profile Visits</div><div class="mc-v sky" id="tsr-pv">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">â• New Followers</div><div class="mc-v g" id="tsr-fol">â€”</div></div>
        <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ’µ Cost/Follower</div><div class="mc-v v" id="tsr-cpf">â€”</div></div>
      </div>
    </div>
  </div></div>
</section>

<!-- ===== LINE ADS ===== -->
<section id="t-ln" class="sec">
  <div class="ph">
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:42px;height:42px;border-radius:10px;background:linear-gradient(135deg,#00B900,#00D900);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">ğŸ’š</div>
      <div><div class="pt" style="margin:0">LINE Ads Calculator</div><div class="pd">LINE Ads Platform, OA Broadcast à¹à¸¥à¸° Shopping</div></div>
    </div>
  </div>
  <div class="str">
    <button class="st on" onclick="lnTab('ads')">ğŸ’š LINE Ads</button>
    <button class="st" onclick="lnTab('broadcast')">ğŸ“¢ OA Broadcast</button>
    <button class="st" onclick="lnTab('shop')">ğŸ›’ LINE Shopping</button>
  </div>

  <!-- LINE Ads Platform -->
  <div id="ln-ads" class="ln-p"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ’š LINE Ads Platform</div><div class="cs">Display Ads à¹ƒà¸™ LINE App</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="lan" type="text" placeholder="LINE Ads Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="lab" type="number" min="0" placeholder="25,000" oninput="calcLA()"></div></div>
        <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">LINE Ads avg. à¸¿150â€“350</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="lacpm" type="number" min="0" placeholder="200" oninput="calcLA()"></div></div>
        <div class="fg"><label class="fl">CTR <span class="tip"><span class="tip-i">i</span><span class="tip-t">LINE avg. 0.3â€“1.5%</span></span></label><div class="iw s"><input class="fi" id="lactr" type="number" min="0" step=".1" placeholder="0.8" oninput="calcLA()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 1â€“3%</span></span></label><div class="iw s"><input class="fi" id="lacvr" type="number" min="0" step=".1" placeholder="2.0" oninput="calcLA()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Add Friend Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆ Add OA à¸ˆà¸²à¸à¹‚à¸†à¸©à¸“à¸² avg. 3â€“10%</span></span></label><div class="iw s"><input class="fi" id="laafr" type="number" min="0" step=".1" placeholder="5.0" oninput="calcLA()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="laprc" type="number" min="0" placeholder="890" oninput="calcLA()"></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveLN('ln_ads','lan')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['lab','lacpm','lactr','lacvr','laafr','laprc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox" style="background:linear-gradient(135deg,#F0FDF4,#E7FAE7);border-color:#86EFAC">
      <div class="rtitle" style="color:#00B900">ğŸ’š LINE Ads Results</div><div class="g2">
        <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ‘ï¸ Impressions</div><div class="mc-v b" id="lar-imp">â€”</div></div>
        <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ‘¥ Est. Reach</div><div class="mc-v t" id="lar-reach">â€”</div></div>
        <div class="mc mc-bg-lime"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v lime" id="lar-clk">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">â• Add Friends</div><div class="mc-v g" id="lar-af">â€”</div></div>
        <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v v" id="lar-con">â€”</div></div>
        <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="lar-cpa">â€”</div></div>
        <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="lar-rev">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="lar-roas">â€”</div></div>
      </div>
    </div>
  </div></div>

  <!-- OA Broadcast -->
  <div id="ln-broadcast" class="ln-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ“¢ LINE OA Broadcast</div><div class="cs">à¸ªà¹ˆà¸‡ Message à¸«à¸² Friends à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="lbn" type="text" placeholder="Broadcast Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Friends Count <span class="tip"><span class="tip-i">i</span><span class="tip-t">à¸ˆà¸³à¸™à¸§à¸™ Friends à¹ƒà¸™ LINE OA à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”</span></span></label><input class="fi" id="lbf" type="number" min="0" placeholder="50,000" oninput="calcLB()"></div>
        <div class="fg"><label class="fl">Broadcast Cost / 1K <span class="tip"><span class="tip-i">i</span><span class="tip-t">à¸„à¹ˆà¸²à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­ 1,000 à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ avg. à¸¿50â€“150</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="lbcpm" type="number" min="0" placeholder="80" oninput="calcLB()"></div></div>
        <div class="fg"><label class="fl">Open Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆà¹€à¸›à¸´à¸”à¸­à¹ˆà¸²à¸™ avg. 40â€“60%</span></span></label><div class="iw s"><input class="fi" id="lbor" type="number" min="0" step="1" placeholder="50" oninput="calcLB()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CTR (from opens) <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 10â€“30%</span></span></label><div class="iw s"><input class="fi" id="lbctr" type="number" min="0" step="1" placeholder="20" oninput="calcLB()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">CVR</label><div class="iw s"><input class="fi" id="lbcvr" type="number" min="0" step=".1" placeholder="5.0" oninput="calcLB()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="lbprc" type="number" min="0" placeholder="690" oninput="calcLB()"></div></div>
      </div>
      <div class="frmbox mt4">
        ğŸ“ <code>Total Cost=(FriendsÃ·1000)Ã—Cost/1K</code><br>
        <code>Opens=FriendsÃ—OR%</code> | <code>Clicks=OpensÃ—CTR%</code> | <code>Conv=ClicksÃ—CVR%</code>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveLN('ln_broadcast','lbn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['lbf','lbcpm','lbor','lbctr','lbcvr','lbprc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox" style="background:linear-gradient(135deg,#F0FDF4,#E7FAE7);border-color:#86EFAC">
      <div class="rtitle" style="color:#00B900">ğŸ“¢ Broadcast Results</div><div class="g2">
        <div class="mc mc-bg-lime"><div class="mc-lbl">ğŸ’° Total Cost</div><div class="mc-v lime" id="lbr-cost">â€”</div><div class="mc-sub">à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸£à¸§à¸¡</div></div>
        <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ“¨ Messages Sent</div><div class="mc-v b" id="lbr-sent">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“– Opens</div><div class="mc-v g" id="lbr-open">â€”</div></div>
        <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v t" id="lbr-clk">â€”</div></div>
        <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v v" id="lbr-con">â€”</div></div>
        <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="lbr-cpa">â€”</div></div>
        <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="lbr-rev">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="lbr-roas">â€”</div></div>
      </div>
    </div>
  </div></div>

  <!-- LINE Shopping -->
  <div id="ln-shop" class="ln-p" style="display:none"><div class="g2">
    <div class="card"><div class="ch"><div><div class="ct">ğŸ›’ LINE Shopping</div><div class="cs">CPC Ads à¸ªà¸³à¸«à¸£à¸±à¸šà¸ªà¸´à¸™à¸„à¹‰à¸² E-Commerce</div></div></div><div class="cb">
      <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="lsn" type="text" placeholder="LINE Shopping Campaign"></div>
      <div class="g2">
        <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="lsb" type="number" min="0" placeholder="15,000" oninput="calcLS()"></div></div>
        <div class="fg"><label class="fl">CPC <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. à¸¿3â€“15 à¸•à¹ˆà¸­à¸„à¸¥à¸´à¸</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="lscpc" type="number" min="0" step=".5" placeholder="8" oninput="calcLS()"></div></div>
        <div class="fg"><label class="fl">CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. 2â€“5%</span></span></label><div class="iw s"><input class="fi" id="lscvr" type="number" min="0" step=".1" placeholder="3.0" oninput="calcLS()"><span class="isuf">%</span></div></div>
        <div class="fg"><label class="fl">Avg. Order Value <span class="tip"><span class="tip-i">i</span><span class="tip-t">à¸¡à¸¹à¸¥à¸„à¹ˆà¸²à¹€à¸‰à¸¥à¸µà¹ˆà¸¢à¸•à¹ˆà¸­à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­</span></span></label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="lsprc" type="number" min="0" placeholder="590" oninput="calcLS()"></div></div>
        <div class="fg"><label class="fl">Add to Cart Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% à¸—à¸µà¹ˆà¹€à¸‚à¹‰à¸²à¸Šà¸¡à¹à¸¥à¹‰à¸§à¹€à¸à¸´à¹ˆà¸¡à¸¥à¸‡à¸•à¸°à¸à¸£à¹‰à¸²</span></span></label><div class="iw s"><input class="fi" id="lsatc" type="number" min="0" step=".1" placeholder="15" oninput="calcLS()"><span class="isuf">%</span></div></div>
      </div>
      <div class="brow mt4"><button class="btn btn-p" onclick="saveLN('ln_shopping','lsn')">ğŸ’¾ Save</button><button class="btn btn-g" onclick="clearFb(['lsb','lscpc','lscvr','lsprc','lsatc'])">ğŸ”„</button></div>
    </div></div>
    <div class="rbox" style="background:linear-gradient(135deg,#F0FDF4,#E7FAE7);border-color:#86EFAC">
      <div class="rtitle" style="color:#00B900">ğŸ›’ Shopping Results</div><div class="g2">
        <div class="mc mc-bg-lime"><div class="mc-lbl">ğŸ–±ï¸ Clicks</div><div class="mc-v lime" id="lsr-clk">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ›’ Add to Cart</div><div class="mc-v g" id="lsr-atc">â€”</div></div>
        <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Orders</div><div class="mc-v v" id="lsr-con">â€”</div></div>
        <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ’° CPA</div><div class="mc-v a" id="lsr-cpa">â€”</div></div>
        <div class="mc mc-bg-t"><div class="mc-lbl">ğŸ“¦ Revenue</div><div class="mc-v t" id="lsr-rev">â€”</div></div>
        <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“ˆ ROAS</div><div class="mc-v g" id="lsr-roas">â€”</div></div>
      </div>
    </div>
  </div></div>
</section>

<!-- ===== CAMPAIGNS ===== -->
<section id="t-camps" class="sec">
  <div class="ph-row mb6">
    <div><div class="pt">Campaign Manager</div><div class="pd">à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸š à¹à¸à¹‰à¹„à¸‚ à¹à¸¥à¸° Export à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸„à¸¡à¹€à¸›à¸à¸—à¸¸à¸ Platform</div></div>
    <div class="brow"><button class="btn btn-ok" onclick="exportCSV()">ğŸ“¥ Export CSV</button><button class="btn btn-g btn-sm" onclick="clearAll()">ğŸ—‘ï¸ Clear All</button></div>
  </div>
  <div id="ce" class="card"><div class="emp"><div class="emp-i">ğŸ“­</div><div class="emp-t">à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¹à¸„à¸¡à¹€à¸›à¸</div><div class="emp-d">à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸„à¸¡à¹€à¸›à¸à¸ˆà¸²à¸ Platform à¹ƒà¸”à¸à¹‡à¹„à¸”à¹‰à¹à¸¥à¹‰à¸§à¸à¸” Save</div></div></div>
  <div id="cc" style="display:none">
    <div class="g4 mb6" id="cs2"></div>
    <div class="card">
      <div class="ch"><div class="ct">ğŸ“‹ All Campaigns</div><div style="font-size:12px;color:var(--t3)" id="ccount">0</div></div>
      <div class="tw">
        <table>
          <thead><tr><th>Campaign</th><th>Platform</th><th>Type</th><th>Budget</th><th>Impressions</th><th>Clicks</th><th>CTR</th><th>Conversions</th><th>CPA</th><th>Revenue</th><th>ROAS</th><th>Actions</th></tr></thead>
          <tbody id="ctbl"></tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<!-- ===== KPI ===== -->
<section id="t-kpi" class="sec">
  <div class="ph"><div class="pt">ğŸ¯ KPI Tracking â€” Actual vs Target</div><div class="pd">à¸•à¸±à¹‰à¸‡à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢ KPI à¹à¸¥à¸°à¸•à¸´à¸”à¸•à¸²à¸¡à¸œà¸¥à¸ˆà¸£à¸´à¸‡à¸‚à¸­à¸‡à¹à¸•à¹ˆà¸¥à¸°à¹à¸„à¸¡à¹€à¸›à¸</div></div>
  <div id="ke" class="card"><div class="emp"><div class="emp-i">ğŸ¯</div><div class="emp-t">à¹„à¸¡à¹ˆà¸¡à¸µà¹à¸„à¸¡à¹€à¸›à¸</div><div class="emp-d">à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸„à¸¡à¹€à¸›à¸à¸à¹ˆà¸­à¸™ à¹à¸¥à¹‰à¸§à¸à¸¥à¸±à¸šà¸¡à¸²à¸•à¸±à¹‰à¸‡ KPI Target à¸—à¸µà¹ˆà¸™à¸µà¹ˆ</div></div></div>
  <div id="kc"></div>
</section>

<!-- ===== DASHBOARD ===== -->
<section id="t-dash" class="sec">
  <div class="ph"><div class="pt">ğŸ“ˆ Performance Dashboard</div><div class="pd">à¸ à¸²à¸à¸£à¸§à¸¡à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¹à¸„à¸¡à¹€à¸›à¸à¸—à¸¸à¸ Platform</div></div>
  <div id="de" class="card"><div class="emp"><div class="emp-i">ğŸ“Š</div><div class="emp-t">à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥</div><div class="emp-d">à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸„à¸¡à¹€à¸›à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 1 à¸£à¸²à¸¢à¸à¸²à¸£</div></div></div>
  <div id="dc" style="display:none">
    <div class="sstrip" id="dstrip"></div>
    <div class="g2 mb6">
      <div class="chc"><div class="cht">Budget by Campaign</div><div class="chs">à¸‡à¸šà¸›à¸£à¸°à¸¡à¸²à¸“à¹à¸•à¹ˆà¸¥à¸°à¹à¸„à¸¡à¹€à¸›à¸</div><div class="chw"><canvas id="ch1"></canvas></div></div>
      <div class="chc"><div class="cht">ROAS Comparison</div><div class="chs">à¹€à¸ªà¹‰à¸™à¹à¸”à¸‡ = Target 3x</div><div class="chw"><canvas id="ch2"></canvas></div></div>
    </div>
    <div class="g3 mb6">
      <div class="chc"><div class="cht">Impressions vs Clicks</div><div class="chs">à¸à¸²à¸£à¹à¸ªà¸”à¸‡à¸œà¸¥ & à¸„à¸¥à¸´à¸</div><div class="chw"><canvas id="ch3"></canvas></div></div>
      <div class="chc"><div class="cht">CPA vs Product Price</div><div class="chs">à¸•à¹‰à¸™à¸—à¸¸à¸™à¸•à¹ˆà¸­ Conversion</div><div class="chw"><canvas id="ch4"></canvas></div></div>
      <div class="chc"><div class="cht">Platform Mix</div><div class="chs">à¸ªà¸±à¸”à¸ªà¹ˆà¸§à¸™à¹à¸•à¹ˆà¸¥à¸° Platform</div><div class="chw"><canvas id="ch5"></canvas></div></div>
    </div>
  </div>
</section>

</main>

<script>
// ============================================================
// DATA
// ============================================================
let DB = JSON.parse(localStorage.getItem('adm4') || '[]');
let CHARTS = {};

const TMAP = {
  media_buying:'Media Buying',
  fb_page_like:'FB Page Like', fb_engagement:'FB Engagement', fb_lead:'FB Lead', fb_video:'FB Video',
  gg_search:'Google Search', gg_display:'Google Display', gg_youtube:'YouTube',
  tt_infeed:'TikTok In-Feed', tt_topview:'TikTok TopView', tt_spark:'TikTok Spark',
  ln_ads:'LINE Ads', ln_broadcast:'LINE Broadcast', ln_shopping:'LINE Shopping'
};

const TPLATFORM = {
  media_buying:'ğŸ“Š Media',
  fb_page_like:'ğŸ“˜ Facebook', fb_engagement:'ğŸ“˜ Facebook', fb_lead:'ğŸ“˜ Facebook', fb_video:'ğŸ“˜ Facebook',
  gg_search:'ğŸ” Google', gg_display:'ğŸ” Google', gg_youtube:'ğŸ” Google',
  tt_infeed:'ğŸµ TikTok', tt_topview:'ğŸµ TikTok', tt_spark:'ğŸµ TikTok',
  ln_ads:'ğŸ’š LINE', ln_broadcast:'ğŸ’š LINE', ln_shopping:'ğŸ’š LINE'
};

const TBDG = {
  media_buying:'bdg-b',
  fb_page_like:'bdg-b', fb_engagement:'bdg-a', fb_lead:'bdg-v', fb_video:'bdg-r',
  gg_search:'bdg-sky', gg_display:'bdg-sky', gg_youtube:'bdg-r',
  tt_infeed:'bdg-dark', tt_topview:'bdg-dark', tt_spark:'bdg-rose',
  ln_ads:'bdg-green', ln_broadcast:'bdg-green', ln_shopping:'bdg-lime'
};

const COLORS = ['#3B82F6','#8B5CF6','#10B981','#F59E0B','#EF4444','#06B6D4','#1A73E8','#34A853','#FE2C55','#00B900','#FF6384','#36A2EB','#FFCE56','#4BC0C0'];

// ============================================================
// UTILS
// ============================================================
const G = id => { const e = document.getElementById(id); return e ? parseFloat(e.value)||0 : 0; };
const GS = id => { const e = document.getElementById(id); return e ? e.value.trim() : ''; };
const $ = id => document.getElementById(id);
const SET = (id,v) => { const e=$(id); if(e) e.textContent=v; };

function f(n,d=0){ if(!isFinite(n)||isNaN(n)) return 'â€”'; return Number(n).toLocaleString('th-TH',{minimumFractionDigits:d,maximumFractionDigits:d}); }
function fc(n,d=0){ return isFinite(n)&&!isNaN(n)&&n>=0 ? 'à¸¿'+f(n,d) : 'â€”'; }
function fp(n,d=2){ return isFinite(n)&&!isNaN(n) ? f(n,d)+'%' : 'â€”'; }
function fr(n){ return isFinite(n)&&!isNaN(n)&&n>0 ? f(n,2)+'x' : 'â€”'; }
function fm(n){ if(!isFinite(n)||isNaN(n)) return 'â€”'; if(n>=1e6) return f(n/1e6,2)+'M'; if(n>=1000) return f(n/1000,1)+'K'; return f(n,0); }
function uid(){ return Date.now().toString(36)+Math.random().toString(36).slice(2,6); }
function esc(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function save(){
  localStorage.setItem('adm4',JSON.stringify(DB));
  refreshHeader(); refreshBadge();
}

// ============================================================
// NAV
// ============================================================
const TABS = ['calc','fb','gg','tt','ln','camps','kpi','dash'];

function goTab(tab){
  document.querySelectorAll('.sec').forEach(s=>s.classList.remove('on'));
  document.querySelectorAll('.nb').forEach(b=>b.classList.remove('on'));
  $('t-'+tab)?.classList.add('on');
  document.querySelectorAll('.nb')[TABS.indexOf(tab)]?.classList.add('on');
  if(tab==='camps') renderCamps();
  if(tab==='kpi') renderKPI();
  if(tab==='dash') renderDash();
}

function fbTab(tab){
  document.querySelectorAll('.fb-p').forEach(p=>p.style.display='none');
  document.querySelectorAll('#t-fb .st').forEach(b=>b.classList.remove('on'));
  $('fb-'+tab).style.display='block';
  const idx=['like','eng','lead','vid'].indexOf(tab);
  document.querySelectorAll('#t-fb .st')[idx]?.classList.add('on');
}

function ggTab(tab){
  document.querySelectorAll('.gg-p').forEach(p=>p.style.display='none');
  document.querySelectorAll('#t-gg .st').forEach(b=>b.classList.remove('on'));
  $('gg-'+tab).style.display='block';
  const idx=['search','display','youtube'].indexOf(tab);
  document.querySelectorAll('#t-gg .st')[idx]?.classList.add('on');
}

function ttTab(tab){
  document.querySelectorAll('.tt-p').forEach(p=>p.style.display='none');
  document.querySelectorAll('#t-tt .st').forEach(b=>b.classList.remove('on'));
  $('tt-'+tab).style.display='block';
  const idx=['infeed','topview','spark'].indexOf(tab);
  document.querySelectorAll('#t-tt .st')[idx]?.classList.add('on');
}

function lnTab(tab){
  document.querySelectorAll('.ln-p').forEach(p=>p.style.display='none');
  document.querySelectorAll('#t-ln .st').forEach(b=>b.classList.remove('on'));
  $('ln-'+tab).style.display='block';
  const idx=['ads','broadcast','shop'].indexOf(tab);
  document.querySelectorAll('#t-ln .st')[idx]?.classList.add('on');
}

// ============================================================
// MEDIA BUYING
// ============================================================
function calcM(){
  const b=G('cb2'),cpm=G('ccpm'),cpc=G('ccpc'),cvr=G('ccvr')/100,prc=G('cprc');
  if(!b){ ['ri','rc','rv','rpa','rrev','rroas','rpro','rctr','recpm','rrpc'].forEach(id=>SET(id,'â€”')); return; }
  const imp=cpm>0?(b/cpm)*1000:0, clk=cpc>0?b/cpc:0, con=clk*cvr;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0;
  const ctr=imp>0?(clk/imp)*100:0, ecpm=imp>0?(b/imp)*1000:0, profit=rev-b;
  SET('ri',fm(imp)); SET('rc',fm(clk)); SET('rv',f(con,1));
  SET('rpa',cpa>0?fc(cpa,2):'â€”'); SET('rrev',rev>0?fc(rev):'â€”');
  SET('rroas',roas>0?fr(roas):'â€”'); SET('rctr',imp>0?fp(ctr,3):'â€”');
  SET('recpm',ecpm>0?fc(ecpm,2):'â€”'); SET('rrpc',prc>0?fc(prc):'â€”');
  const pe=$('rpro'); if(pe){ pe.textContent=rev>0?fc(Math.abs(profit))+(profit<0?' (à¸‚à¸²à¸”à¸—à¸¸à¸™)':''):'â€”'; pe.style.color=profit>=0?'var(--ok)':'var(--bad)'; }
  const pc=$('rpc2'); if(pc&&rev>0) pc.className='mc '+(profit>=0?'mc-bg-g g':'mc-bg-r r');
}
function clearM(){ ['cn','cb2','ccpm','ccpc','ccvr','cprc'].forEach(id=>{ const e=$(id);if(e)e.value=''; }); calcM(); }
function saveM(){
  const name=GS('cn')||'Campaign '+(DB.length+1), b=G('cb2');
  if(!b){ toast('âš ï¸ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸ Budget','warn'); return; }
  const cpm=G('ccpm'),cpc=G('ccpc'),cvr=G('ccvr'),prc=G('cprc'),cvrD=cvr/100;
  const imp=cpm>0?(b/cpm)*1000:0, clk=cpc>0?b/cpc:0, con=clk*cvrD;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0, ctr=imp>0?(clk/imp)*100:0;
  pushDB(name,'media_buying',{budget:b,cpm,cpc,cvr,productPrice:prc},{imp,clk,con,cpa,rev,roas,ctr},b);
}

// ============================================================
// FACEBOOK
// ============================================================
function calcLike(){
  const b=G('flb'),cpm=G('flcpm'),cpl=G('flcpl'),rt=G('flr')/100;
  const imp=cpm>0?(b/cpm)*1000:0, reach=imp*0.92;
  const likes=cpl>0?b/cpl:imp*rt, acpl=likes>0?b/likes:0;
  SET('flri',fm(imp));SET('flrr',fm(reach));SET('flrl',fm(likes));SET('flrc',acpl>0?fc(acpl,2):'â€”');
}
function calcEng(){
  const b=G('feb'),cpm=G('fecpm'),cpe=G('fecpe'),rt=G('fer')/100;
  const imp=cpm>0?(b/cpm)*1000:0, reach=imp*0.9;
  const eng=cpe>0?b/cpe:imp*rt, acpe=eng>0?b/eng:0;
  SET('feri',fm(imp));SET('ferr',fm(reach));SET('fere',fm(eng));SET('ferc',acpe>0?fc(acpe,2):'â€”');
}
function calcLead(){
  const b=G('fldb'),cpm=G('fldcpm'),ctr=G('fldctr')/100,ffr=G('fldf')/100,prc=G('fldp'),cvr=G('fldcvr')/100;
  const imp=cpm>0?(b/cpm)*1000:0, clk=imp*ctr, leads=clk*ffr;
  const cpl=leads>0?b/leads:0, sales=leads*cvr, rev=sales*prc, roas=b>0&&rev>0?rev/b:0;
  SET('fldri',fm(imp));SET('fldrc',fm(clk));SET('fldrl',f(leads,1));SET('fldra',cpl>0?fc(cpl,2):'â€”');SET('fldrs',f(sales,1));SET('fldrr',roas>0?fr(roas):'â€”');
}
function calcVid(){
  const b=G('fvb'),cpm=G('fvcpm'),r2=G('fv2')/100,rt=G('fvt')/100,cpv=G('fvcpv');
  const imp=cpm>0?(b/cpm)*1000:0, v2=imp*r2;
  const thru=cpv>0?b/cpv:imp*rt, acpv=thru>0?b/thru:0;
  const vr=imp>0?(thru/imp)*100:0, ecpm=imp>0?(b/imp)*1000:0;
  SET('fvri',fm(imp));SET('fvr2',fm(v2));SET('fvrt',fm(thru));SET('fvrc',acpv>0?fc(acpv,2):'â€”');SET('fvrr',fp(vr,1));SET('fvre',ecpm>0?fc(ecpm,2):'â€”');
}
function clearFb(ids){ ids.forEach(id=>{ const e=$(id);if(e)e.value=''; }); }
function saveFb(type,nid){
  const name=GS(nid)||TMAP[type]+' '+(DB.length+1);
  let b=0,inp={},imp=0,clk=0,con=0,cpa=0,rev=0,roas=0,ctr=0;
  if(type==='fb_page_like'){
    b=G('flb');const cpm=G('flcpm'),cpl=G('flcpl'),rt=G('flr')/100;
    imp=cpm>0?(b/cpm)*1000:0;clk=cpl>0?b/cpl:imp*rt;con=clk;cpa=clk>0?b/clk:0;ctr=imp>0?(clk/imp)*100:0;
    inp={budget:b,cpm,cpl,likeRate:rt*100};
  } else if(type==='fb_engagement'){
    b=G('feb');const cpm=G('fecpm'),cpe=G('fecpe'),rt=G('fer')/100;
    imp=cpm>0?(b/cpm)*1000:0;clk=cpe>0?b/cpe:imp*rt;con=clk;cpa=clk>0?b/clk:0;ctr=imp>0?(clk/imp)*100:0;
    inp={budget:b,cpm,cpe,engRate:rt*100};
  } else if(type==='fb_lead'){
    b=G('fldb');const cpm=G('fldcpm'),ctrR=G('fldctr')/100,ffr=G('fldf')/100,prc=G('fldp'),cvr=G('fldcvr')/100;
    imp=cpm>0?(b/cpm)*1000:0;clk=imp*ctrR;con=clk*ffr;cpa=con>0?b/con:0;
    const sales=con*cvr;rev=sales*prc;roas=b>0&&rev>0?rev/b:0;ctr=imp>0?(clk/imp)*100:0;
    inp={budget:b,cpm,ctr:ctrR*100,formFillRate:ffr*100,productPrice:prc,cvr:cvr*100};
  } else if(type==='fb_video'){
    b=G('fvb');const cpm=G('fvcpm'),r2=G('fv2')/100,rt=G('fvt')/100,cpv=G('fvcpv');
    imp=cpm>0?(b/cpm)*1000:0;clk=cpv>0?b/cpv:imp*rt;con=clk;cpa=clk>0?b/clk:0;ctr=imp>0?(clk/imp)*100:0;
    inp={budget:b,cpm,cpv,view2s:r2*100,thruRate:rt*100};
  }
  if(!b){ toast('âš ï¸ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸ Budget','warn'); return; }
  pushDB(name,type,inp,{imp,clk,con,cpa,rev,roas,ctr},b);
}

// ============================================================
// GOOGLE
// ============================================================
function calcGS(){
  const b=G('gsb'),cpc=G('gscpc'),ctr=G('gsctr')/100,cvr=G('gscvr')/100,qs=G('gsqs')||7,prc=G('gsprc');
  const adjCPC=cpc>0?cpc*(10/qs):0;
  const clk=adjCPC>0?b/adjCPC:cpc>0?b/cpc:0;
  const imp=ctr>0?clk/ctr:0, con=clk*cvr;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0;
  SET('gsr-imp',fm(imp)); SET('gsr-clk',fm(clk)); SET('gsr-con',f(con,1));
  SET('gsr-cpa',cpa>0?fc(cpa,2):'â€”'); SET('gsr-rev',rev>0?fc(rev):'â€”');
  SET('gsr-roas',roas>0?fr(roas):'â€”'); SET('gsr-acpc',adjCPC>0?fc(adjCPC,2):'â€”');
  SET('gsr-ctr',fp(ctr*100,2));
}
function calcGD(){
  const b=G('gdb'),cpm=G('gdcpm'),ctr=G('gdctr')/100,cvr=G('gdcvr')/100,freq=G('gdfreq')||1,prc=G('gdprc');
  const imp=cpm>0?(b/cpm)*1000:0, reach=freq>0?imp/freq:imp;
  const clk=imp*ctr, con=clk*cvr;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0;
  const ecpc=clk>0?b/clk:0;
  SET('gdr-imp',fm(imp));SET('gdr-reach',fm(reach));SET('gdr-clk',fm(clk));SET('gdr-con',f(con,1));
  SET('gdr-cpa',cpa>0?fc(cpa,2):'â€”');SET('gdr-rev',rev>0?fc(rev):'â€”');SET('gdr-roas',roas>0?fr(roas):'â€”');SET('gdr-ecpc',ecpc>0?fc(ecpc,2):'â€”');
}
function calcGY(){
  const b=G('gyb'),cpm=G('gycpm'),vr=G('gyvr')/100,ctr=G('gyctr')/100,cvr=G('gycvr')/100,prc=G('gyprc');
  const imp=cpm>0?(b/cpm)*1000:0, views=imp*vr;
  const cpv=views>0?b/views:0, clk=views*ctr, con=clk*cvr;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0;
  SET('gyr-imp',fm(imp));SET('gyr-view',fm(views));SET('gyr-cpv',cpv>0?fc(cpv,2):'â€”');
  SET('gyr-clk',fm(clk));SET('gyr-con',f(con,1));SET('gyr-rev',rev>0?fc(rev):'â€”');
  SET('gyr-roas',roas>0?fr(roas):'â€”');SET('gyr-vr',fp(vr*100,1));
}
function saveGG(type,nid){
  const name=GS(nid)||TMAP[type]+' '+(DB.length+1);
  let b=0,inp={},imp=0,clk=0,con=0,cpa=0,rev=0,roas=0,ctr=0;
  if(type==='gg_search'){
    b=G('gsb');const cpc=G('gscpc'),ctrR=G('gsctr')/100,cvr=G('gscvr')/100,qs=G('gsqs')||7,prc=G('gsprc');
    const adjCPC=cpc>0?cpc*(10/qs):cpc;
    clk=adjCPC>0?b/adjCPC:0;imp=ctrR>0?clk/ctrR:0;con=clk*cvr;
    cpa=con>0?b/con:0;rev=con*prc;roas=b>0&&rev>0?rev/b:0;ctr=ctrR*100;
    inp={budget:b,cpc,ctr:ctrR*100,cvr:cvr*100,qualityScore:qs,productPrice:prc};
  } else if(type==='gg_display'){
    b=G('gdb');const cpm=G('gdcpm'),ctrR=G('gdctr')/100,cvr=G('gdcvr')/100,freq=G('gdfreq')||1,prc=G('gdprc');
    imp=cpm>0?(b/cpm)*1000:0;clk=imp*ctrR;con=clk*cvr;
    cpa=con>0?b/con:0;rev=con*prc;roas=b>0&&rev>0?rev/b:0;ctr=ctrR*100;
    inp={budget:b,cpm,ctr:ctrR*100,cvr:cvr*100,frequency:freq,productPrice:prc};
  } else if(type==='gg_youtube'){
    b=G('gyb');const cpm=G('gycpm'),vr=G('gyvr')/100,ctrR=G('gyctr')/100,cvr=G('gycvr')/100,prc=G('gyprc');
    imp=cpm>0?(b/cpm)*1000:0;const views=imp*vr;clk=views*ctrR;con=clk*cvr;
    cpa=con>0?b/con:0;rev=con*prc;roas=b>0&&rev>0?rev/b:0;ctr=ctrR*100;
    inp={budget:b,cpm,viewRate:vr*100,ctr:ctrR*100,cvr:cvr*100,productPrice:prc};
  }
  if(!b){ toast('âš ï¸ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸ Budget','warn'); return; }
  pushDB(name,type,inp,{imp,clk,con,cpa,rev,roas,ctr},b);
}

// ============================================================
// TIKTOK
// ============================================================
function calcTTI(){
  const b=G('tib'),cpm=G('ticpm'),ctr=G('titr')/100,cvr=G('ticvr')/100,vr=G('tivr')/100,prc=G('tiprc');
  const imp=cpm>0?(b/cpm)*1000:0, vv=imp*vr, clk=imp*ctr, con=clk*cvr;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0;
  const ecpm=imp>0?(b/imp)*1000:0;
  SET('tir-imp',fm(imp));SET('tir-vv',fm(vv));SET('tir-clk',fm(clk));SET('tir-con',f(con,1));
  SET('tir-cpa',cpa>0?fc(cpa,2):'â€”');SET('tir-rev',rev>0?fc(rev):'â€”');SET('tir-roas',roas>0?fr(roas):'â€”');SET('tir-ecpm',ecpm>0?fc(ecpm,2):'â€”');
}
function calcTTV(){
  const b=G('tvb'),cpm=G('tvcpm'),fvr=G('tvfvr')/100,ctr=G('tvctr')/100,cvr=G('tvcvr')/100,prc=G('tvprc');
  const imp=cpm>0?(b/cpm)*1000:0, fv=imp*fvr, clk=imp*ctr, con=clk*cvr;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0, cpv=fv>0?b/fv:0;
  SET('tvr-imp',fm(imp));SET('tvr-fv',fm(fv));SET('tvr-clk',fm(clk));SET('tvr-con',f(con,1));
  SET('tvr-cpa',cpa>0?fc(cpa,2):'â€”');SET('tvr-rev',rev>0?fc(rev):'â€”');SET('tvr-roas',roas>0?fr(roas):'â€”');SET('tvr-cpv',cpv>0?fc(cpv,2):'â€”');
}
function calcTTS(){
  const b=G('tsb'),cpm=G('tscpm'),cpe=G('tscpe'),er=G('tser')/100,pvr=G('tspvr')/100,fr2=G('tsfr')/100;
  const imp=cpm>0?(b/cpm)*1000:0;
  const eng=cpe>0?b/cpe:imp*er, acpe=eng>0?b/eng:0;
  const pv=eng*pvr, fol=pv*fr2, cpf=fol>0?b/fol:0;
  SET('tsr-imp',fm(imp));SET('tsr-eng',fm(eng));SET('tsr-cpe',acpe>0?fc(acpe,2):'â€”');
  SET('tsr-pv',fm(pv));SET('tsr-fol',fm(fol));SET('tsr-cpf',cpf>0?fc(cpf,2):'â€”');
}
function saveTT(type,nid){
  const name=GS(nid)||TMAP[type]+' '+(DB.length+1);
  let b=0,inp={},imp=0,clk=0,con=0,cpa=0,rev=0,roas=0,ctr=0;
  if(type==='tt_infeed'){
    b=G('tib');const cpm=G('ticpm'),ctrR=G('titr')/100,cvr=G('ticvr')/100,vr=G('tivr')/100,prc=G('tiprc');
    imp=cpm>0?(b/cpm)*1000:0;clk=imp*ctrR;con=clk*cvr;cpa=con>0?b/con:0;rev=con*prc;roas=b>0&&rev>0?rev/b:0;ctr=ctrR*100;
    inp={budget:b,cpm,ctr:ctrR*100,cvr:cvr*100,videoViewRate:vr*100,productPrice:prc};
  } else if(type==='tt_topview'){
    b=G('tvb');const cpm=G('tvcpm'),fvr=G('tvfvr')/100,ctrR=G('tvctr')/100,cvr=G('tvcvr')/100,prc=G('tvprc');
    imp=cpm>0?(b/cpm)*1000:0;clk=imp*ctrR;con=clk*cvr;cpa=con>0?b/con:0;rev=con*prc;roas=b>0&&rev>0?rev/b:0;ctr=ctrR*100;
    inp={budget:b,cpm,fullViewRate:fvr*100,ctr:ctrR*100,cvr:cvr*100,productPrice:prc};
  } else if(type==='tt_spark'){
    b=G('tsb');const cpm=G('tscpm'),cpe=G('tscpe'),er=G('tser')/100;
    imp=cpm>0?(b/cpm)*1000:0;clk=cpe>0?b/cpe:imp*er;con=clk;cpa=clk>0?b/clk:0;ctr=imp>0?(clk/imp)*100:0;
    inp={budget:b,cpm,cpe};
  }
  if(!b){ toast('âš ï¸ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸ Budget','warn'); return; }
  pushDB(name,type,inp,{imp,clk,con,cpa,rev,roas,ctr},b);
}

// ============================================================
// LINE
// ============================================================
function calcLA(){
  const b=G('lab'),cpm=G('lacpm'),ctr=G('lactr')/100,cvr=G('lacvr')/100,afr=G('laafr')/100,prc=G('laprc');
  const imp=cpm>0?(b/cpm)*1000:0, reach=imp*0.9, clk=imp*ctr;
  const af=reach*afr, con=clk*cvr, cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0;
  SET('lar-imp',fm(imp));SET('lar-reach',fm(reach));SET('lar-clk',fm(clk));SET('lar-af',fm(af));
  SET('lar-con',f(con,1));SET('lar-cpa',cpa>0?fc(cpa,2):'â€”');SET('lar-rev',rev>0?fc(rev):'â€”');SET('lar-roas',roas>0?fr(roas):'â€”');
}
function calcLB(){
  const fn=G('lbf'),cpm1k=G('lbcpm'),or=G('lbor')/100,ctr=G('lbctr')/100,cvr=G('lbcvr')/100,prc=G('lbprc');
  const cost=(fn/1000)*cpm1k, opens=fn*or, clk=opens*ctr, con=clk*cvr;
  const cpa=con>0?cost/con:0, rev=con*prc, roas=cost>0&&rev>0?rev/cost:0;
  SET('lbr-cost',fc(cost));SET('lbr-sent',fm(fn));SET('lbr-open',fm(opens));SET('lbr-clk',fm(clk));
  SET('lbr-con',f(con,1));SET('lbr-cpa',cpa>0?fc(cpa,2):'â€”');SET('lbr-rev',rev>0?fc(rev):'â€”');SET('lbr-roas',roas>0?fr(roas):'â€”');
}
function calcLS(){
  const b=G('lsb'),cpc=G('lscpc'),cvr=G('lscvr')/100,prc=G('lsprc'),atcr=G('lsatc')/100;
  const clk=cpc>0?b/cpc:0, atc=clk*atcr, con=clk*cvr;
  const cpa=con>0?b/con:0, rev=con*prc, roas=b>0&&rev>0?rev/b:0;
  SET('lsr-clk',fm(clk));SET('lsr-atc',fm(atc));SET('lsr-con',f(con,1));
  SET('lsr-cpa',cpa>0?fc(cpa,2):'â€”');SET('lsr-rev',rev>0?fc(rev):'â€”');SET('lsr-roas',roas>0?fr(roas):'â€”');
}
function saveLN(type,nid){
  const name=GS(nid)||TMAP[type]+' '+(DB.length+1);
  let b=0,inp={},imp=0,clk=0,con=0,cpa=0,rev=0,roas=0,ctr=0;
  if(type==='ln_ads'){
    b=G('lab');const cpm=G('lacpm'),ctrR=G('lactr')/100,cvr=G('lacvr')/100,afr=G('laafr')/100,prc=G('laprc');
    imp=cpm>0?(b/cpm)*1000:0;clk=imp*ctrR;con=clk*cvr;cpa=con>0?b/con:0;rev=con*prc;roas=b>0&&rev>0?rev/b:0;ctr=ctrR*100;
    inp={budget:b,cpm,ctr:ctrR*100,cvr:cvr*100,addFriendRate:afr*100,productPrice:prc};
  } else if(type==='ln_broadcast'){
    const fn=G('lbf'),cpm1k=G('lbcpm');
    b=(fn/1000)*cpm1k;
    const or=G('lbor')/100,ctrR=G('lbctr')/100,cvr=G('lbcvr')/100,prc=G('lbprc');
    imp=fn; clk=fn*or*ctrR; con=clk*cvr; cpa=con>0?b/con:0; rev=con*prc; roas=b>0&&rev>0?rev/b:0;
    ctr=(or*ctrR)*100;
    inp={budget:b,friends:fn,costPer1k:cpm1k,openRate:or*100,ctr:ctrR*100,cvr:cvr*100,productPrice:prc};
  } else if(type==='ln_shopping'){
    b=G('lsb');const cpc=G('lscpc'),cvr=G('lscvr')/100,prc=G('lsprc');
    clk=cpc>0?b/cpc:0;con=clk*cvr;cpa=con>0?b/con:0;rev=con*prc;roas=b>0&&rev>0?rev/b:0;
    inp={budget:b,cpc,cvr:cvr*100,productPrice:prc};
  }
  if(!b){ toast('âš ï¸ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸ Budget/à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¹‰à¸„à¸£à¸š','warn'); return; }
  pushDB(name,type,inp,{imp,clk,con,cpa,rev,roas,ctr},b);
}

// ============================================================
// GENERIC PUSH
// ============================================================
function pushDB(name,type,inputs,results,budget){
  DB.push({
    id:uid(),name,type,inputs,results,
    kpi:{tBudget:budget,tImp:0,tClk:0,tCon:0,tROAS:0,tCPA:0},
    actual:{budget:0,imp:0,clk:0,con:0,rev:0},
    at:new Date().toISOString()
  });
  save();
  toast('âœ… à¸šà¸±à¸™à¸—à¸¶à¸ "'+name+'"','ok');
}

// ============================================================
// CAMPAIGNS
// ============================================================
function agg(){ return DB.reduce((a,c)=>({budget:a.budget+(c.inputs.budget||0),rev:a.rev+(c.results.rev||0),imp:a.imp+(c.results.imp||0),clk:a.clk+(c.results.clk||0),con:a.con+(c.results.con||0)}),{budget:0,rev:0,imp:0,clk:0,con:0}); }

function renderCamps(){
  const empty=$('ce'),cont=$('cc');
  if(!DB.length){ empty.style.display='block';cont.style.display='none'; return; }
  empty.style.display='none';cont.style.display='block';
  const tot=agg();
  $('cs2').innerHTML=`
    <div class="mc mc-bg-b"><div class="mc-lbl">ğŸ’¼ Total Budget</div><div class="mc-v b">${fc(tot.budget)}</div><div class="mc-sub">${DB.length} campaigns</div></div>
    <div class="mc mc-bg-g"><div class="mc-lbl">ğŸ“¦ Total Revenue</div><div class="mc-v g">${tot.rev>0?fc(tot.rev):'â€”'}</div></div>
    <div class="mc mc-bg-a"><div class="mc-lbl">ğŸ“ˆ Blended ROAS</div><div class="mc-v a">${tot.rev>0?fr(tot.rev/tot.budget):'â€”'}</div></div>
    <div class="mc mc-bg-v"><div class="mc-lbl">ğŸ¯ Conversions</div><div class="mc-v v">${f(tot.con,1)}</div></div>
  `;
  $('ccount').textContent=DB.length+' campaigns';
  $('ctbl').innerHTML=DB.map(c=>`
    <tr>
      <td><div class="tn">${esc(c.name)}</div><div class="tnm">${new Date(c.at).toLocaleDateString('th-TH')}</div></td>
      <td style="font-size:12px;white-space:nowrap">${TPLATFORM[c.type]||''}</td>
      <td><span class="bdg ${TBDG[c.type]}">${TMAP[c.type]}</span></td>
      <td class="tv">${fc(c.inputs.budget)}</td>
      <td class="tv">${fm(c.results.imp)}</td>
      <td class="tv">${fm(c.results.clk)}</td>
      <td class="tv">${c.results.ctr>0?fp(c.results.ctr,2):'â€”'}</td>
      <td class="tv">${f(c.results.con,1)}</td>
      <td class="tv">${c.results.cpa>0?fc(c.results.cpa,2):'â€”'}</td>
      <td class="tv">${c.results.rev>0?fc(c.results.rev):'â€”'}</td>
      <td class="tv">${c.results.roas>0?fr(c.results.roas):'â€”'}</td>
      <td><div class="brow" style="gap:6px">
        <button class="btn btn-ol btn-sm" onclick="loadCamp('${c.id}')">ğŸ“</button>
        <button class="btn btn-bad btn-sm" onclick="delCamp('${c.id}')">ğŸ—‘ï¸</button>
      </div></td>
    </tr>
  `).join('');
}

function loadCamp(id){
  const c=DB.find(x=>x.id===id);
  if(!c||c.type!=='media_buying'){ toast('â„¹ï¸ Load à¹„à¸”à¹‰à¹€à¸‰à¸à¸²à¸° Media Buying','warn'); return; }
  $('cn').value=c.name;$('cb2').value=c.inputs.budget||'';$('ccpm').value=c.inputs.cpm||'';
  $('ccpc').value=c.inputs.cpc||'';$('ccvr').value=c.inputs.cvr||'';$('cprc').value=c.inputs.productPrice||'';
  calcM(); goTab('calc'); toast('ğŸ“ à¹‚à¸«à¸¥à¸” "'+c.name+'"','ok');
}
function delCamp(id){ if(!confirm('à¸¥à¸š?')) return; DB=DB.filter(c=>c.id!==id); save(); renderCamps(); toast('ğŸ—‘ï¸ à¸¥à¸šà¹à¸¥à¹‰à¸§','warn'); }
function clearAll(){ if(!DB.length||!confirm('à¸¥à¸šà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” '+DB.length+' à¹à¸„à¸¡à¹€à¸›à¸?')) return; DB=[]; save(); renderCamps(); toast('ğŸ—‘ï¸ à¸¥à¸šà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”','warn'); }

// ============================================================
// CSV
// ============================================================
function exportCSV(){
  if(!DB.length){ toast('âš ï¸ à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥','warn'); return; }
  const H=['Campaign Name','Platform','Type','Date','Budget (THB)','Impressions','Clicks','CTR (%)','Conversions','CPA (THB)','Revenue (THB)','ROAS','KPI Target Budget','KPI Target Imp','KPI Target Clicks','KPI Target Conv','KPI Target ROAS','KPI Target CPA','Actual Budget Spent','Actual Impressions','Actual Clicks','Actual Conversions','Actual Revenue','Actual ROAS','Actual CPA'];
  const rows=DB.map(c=>{
    const aROAS=c.actual.budget>0&&c.actual.rev>0?c.actual.rev/c.actual.budget:0;
    const aCPA=c.actual.budget>0&&c.actual.con>0?c.actual.budget/c.actual.con:0;
    return ['"'+c.name.replace(/"/g,'""')+'"',TPLATFORM[c.type]||'',TMAP[c.type],new Date(c.at).toLocaleDateString('th-TH'),
      c.inputs.budget||0,Math.round(c.results.imp||0),Math.round(c.results.clk||0),(c.results.ctr||0).toFixed(3),
      (c.results.con||0).toFixed(2),(c.results.cpa||0).toFixed(2),(c.results.rev||0).toFixed(2),(c.results.roas||0).toFixed(2),
      c.kpi.tBudget||0,c.kpi.tImp||0,c.kpi.tClk||0,c.kpi.tCon||0,c.kpi.tROAS||0,c.kpi.tCPA||0,
      c.actual.budget||0,c.actual.imp||0,c.actual.clk||0,c.actual.con||0,c.actual.rev||0,
      aROAS.toFixed(2),aCPA.toFixed(2)];
  });
  const csv=[H,...rows].map(r=>r.join(',')).join('\n');
  const blob=new Blob(['\ufeff'+csv],{type:'text/csv;charset=utf-8;'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');a.href=url;a.download='admetrics_'+new Date().toISOString().slice(0,10)+'.csv';a.click();URL.revokeObjectURL(url);
  toast('ğŸ“¥ Export CSV à¸ªà¸³à¹€à¸£à¹‡à¸ˆ','ok');
}

// ============================================================
// KPI
// ============================================================
function renderKPI(){
  const em=$('ke'),ct=$('kc');
  if(!DB.length){ em.style.display='block';ct.innerHTML=''; return; }
  em.style.display='none';
  ct.innerHTML=DB.map(c=>buildKPICard(c)).join('');
  DB.forEach(c=>refreshKPI(c.id));
}

function buildKPICard(c){
  const mi=(m,lbl,icon,proj)=>`
    <div class="kmi">
      <div class="kmit">${icon} ${lbl}</div>
      <div class="kmi-g">
        <div class="fg"><label class="fl">Target</label>
          <input class="fi" id="kt-${c.id}-${m}" type="number" min="0" value="${c.kpi['t'+cap(m)]||''}" placeholder="${f(proj,m==='roas'?2:0)}" oninput="refreshKPI('${c.id}')">
        </div>
        <div class="fg"><label class="fl">Actual</label>
          <input class="fi" id="ka-${c.id}-${m}" type="number" min="0" value="${c.actual[m]||''}" placeholder="0" oninput="refreshKPI('${c.id}')">
        </div>
      </div>
      <div id="kp-${c.id}-${m}"></div>
    </div>`;
  return `
    <div class="kpic" id="kpic-${c.id}">
      <div class="kpih">
        <div>
          <div class="kpin">${esc(c.name)}</div>
          <div class="kpim"><span style="background:rgba(255,255,255,.15);color:#fff;padding:2px 8px;border-radius:100px;font-size:10px;font-weight:700">${TPLATFORM[c.type]} Â· ${TMAP[c.type]}</span> &nbsp; ${fc(c.inputs.budget)} &nbsp;|&nbsp; ${new Date(c.at).toLocaleDateString('th-TH')}</div>
        </div>
        <button class="btn btn-sm" style="background:rgba(255,255,255,.18);color:#fff;border:1px solid rgba(255,255,255,.25)" onclick="saveKPI('${c.id}')">ğŸ’¾ Save KPI</button>
      </div>
      <div class="kpib">
        <div style="background:var(--bg);border:1px solid var(--b1);border-radius:var(--r);padding:15px;margin-bottom:15px">
          <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);margin-bottom:11px">ğŸ’° Budget Tracking</div>
          <div class="g2" style="gap:10px;margin-bottom:10px">
            <div class="fg" style="margin:0"><label class="fl">Target Budget</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="kt-${c.id}-budget" type="number" min="0" value="${c.kpi.tBudget||''}" placeholder="${c.inputs.budget}" oninput="refreshKPI('${c.id}')"></div></div>
            <div class="fg" style="margin:0"><label class="fl">Actual Spent</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="ka-${c.id}-budget" type="number" min="0" value="${c.actual.budget||''}" placeholder="0" oninput="refreshKPI('${c.id}')"></div></div>
          </div>
          <div id="kp-${c.id}-budget"></div>
        </div>
        <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);margin-bottom:11px">ğŸ¯ Performance KPIs</div>
        <div class="g3" style="gap:11px">
          ${mi('imp','Impressions','ğŸ‘ï¸',c.results.imp)}
          ${mi('clk','Clicks','ğŸ–±ï¸',c.results.clk)}
          ${mi('con','Conversions','ğŸ¯',c.results.con)}
          ${mi('roas','ROAS','ğŸ“ˆ',c.results.roas)}
          ${mi('cpa','CPA (â†“ better)','ğŸ’°',c.results.cpa)}
          <div class="kmi">
            <div class="kmit">ğŸ“¦ Actual Revenue</div>
            <div class="fg" style="margin:0"><label class="fl">Revenue (à¸¿)</label><div class="iw p"><span class="ipre">à¸¿</span><input class="fi" id="ka-${c.id}-rev" type="number" min="0" value="${c.actual.rev||''}" placeholder="0" oninput="refreshKPI('${c.id}')"></div></div>
            <div style="font-size:11px;color:var(--t3);margin-top:7px">Expected: <strong style="color:var(--ok)">${c.results.rev>0?fc(c.results.rev):'â€”'}</strong></div>
          </div>
        </div>
        <div style="background:var(--bg);border:1px solid var(--b1);border-radius:var(--r);padding:13px;margin-top:14px">
          <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);margin-bottom:9px">ğŸ“ Auto-Calc from Actuals</div>
          <div class="g3" style="gap:8px">
            <div style="text-align:center"><div style="font-size:9px;color:var(--t3);font-weight:700;text-transform:uppercase;margin-bottom:3px">Actual ROAS</div><div id="kac-${c.id}-roas" style="font-size:17px;font-weight:800;color:var(--p)">â€”</div></div>
            <div style="text-align:center"><div style="font-size:9px;color:var(--t3);font-weight:700;text-transform:uppercase;margin-bottom:3px">Actual CPA</div><div id="kac-${c.id}-cpa" style="font-size:17px;font-weight:800;color:var(--warn)">â€”</div></div>
            <div style="text-align:center"><div style="font-size:9px;color:var(--t3);font-weight:700;text-transform:uppercase;margin-bottom:3px">Profit/Loss</div><div id="kac-${c.id}-pro" style="font-size:17px;font-weight:800">â€”</div></div>
          </div>
        </div>
        <div id="kovr-${c.id}"></div>
      </div>
    </div>`;
}

function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }

function refreshKPI(id){
  const tB=parseFloat($(`kt-${id}-budget`)?.value)||0;
  const aB=parseFloat($(`ka-${id}-budget`)?.value)||0;
  const bp=$(`kp-${id}-budget`);
  if(bp){
    if(!tB){ bp.innerHTML='<div style="font-size:10px;color:var(--t3)">à¸à¸£à¸­à¸ Target Budget</div>'; }
    else {
      const pct=aB>0?(aB/tB)*100:0;
      const cl=pct<=90?'g':pct<=100?'a':'r';
      bp.innerHTML=`<div class="prw"><div class="pri"><div class="prl">${fc(aB)} / ${fc(tB)}</div><div class="prp">${f(pct,1)}%</div></div><div class="prt"><div class="prf ${cl}" style="width:${Math.min(pct,100)}%"></div></div><div class="prs">${pct>100?'ğŸ”´ Over Budget':pct>=90?'ğŸŸ¡ Near Limit':'ğŸŸ¢ On Budget'}</div></div>`;
    }
  }
  const metrics=[{k:'imp',lower:false},{k:'clk',lower:false},{k:'con',lower:false},{k:'roas',lower:false},{k:'cpa',lower:true}];
  let scores=[];
  metrics.forEach(m=>{
    const tEl=$(`kt-${id}-${m.k}`),aEl=$(`ka-${id}-${m.k}`),pEl=$(`kp-${id}-${m.k}`);
    if(!tEl||!aEl||!pEl) return;
    let target=parseFloat(tEl.value)||0, actual=parseFloat(aEl.value)||0;
    if(m.k==='roas'&&actual===0){ const ab=parseFloat($(`ka-${id}-budget`)?.value)||0,ar=parseFloat($(`ka-${id}-rev`)?.value)||0;if(ab>0&&ar>0)actual=ar/ab; }
    if(m.k==='cpa'&&actual===0){ const ab=parseFloat($(`ka-${id}-budget`)?.value)||0,ac=parseFloat($(`ka-${id}-con`)?.value)||0;if(ab>0&&ac>0)actual=ab/ac; }
    if(!target||!actual){ pEl.innerHTML='<div style="font-size:10px;color:var(--t3);padding:2px 0">à¸à¸£à¸­à¸ Target & Actual</div>'; return; }
    const pct=m.lower?(target/actual)*100:(actual/target)*100;
    let cl,st,dot;
    if(m.lower){ if(pct>=100){cl='g';st='âœ… On Target';dot='var(--ok)'}else if(pct>=80){cl='a';st='âš ï¸ Slightly Over';dot='var(--warn)'}else{cl='r';st='âŒ Over Limit';dot='var(--bad)'} }
    else{ if(pct>=100){cl='g';st='âœ… Met';dot='var(--ok)'}else if(pct>=75){cl='a';st='âš¡ On Track';dot='var(--warn)'}else{cl='r';st='âŒ Behind';dot='var(--bad)'} }
    scores.push({pct,ok:pct>=75});
    pEl.innerHTML=`<div class="prw"><div class="pri"><div class="prp" style="color:${dot}">${f(pct,1)}% to KPI</div><div style="font-size:10px;color:var(--t3)">${st}</div></div><div class="prt"><div class="prf ${cl}" style="width:${Math.min(pct,100)}%"></div></div></div>`;
  });
  const aREV=parseFloat($(`ka-${id}-rev`)?.value)||0;
  const aROAS=aB>0&&aREV>0?aREV/aB:0;
  const aCON=parseFloat($(`ka-${id}-con`)?.value)||0;
  const aCPA=aB>0&&aCON>0?aB/aCON:0;
  const aProfit=aREV-aB;
  const re=$(`kac-${id}-roas`),ce=$(`kac-${id}-cpa`),pe=$(`kac-${id}-pro`);
  if(re){ re.textContent=aROAS>0?fr(aROAS):'â€”'; re.style.color=aROAS>=3?'var(--ok)':aROAS>0?'var(--warn)':'var(--t3)'; }
  if(ce) ce.textContent=aCPA>0?fc(aCPA,2):'â€”';
  if(pe){ pe.textContent=aB>0&&aREV>0?fc(Math.abs(aProfit))+(aProfit<0?' ğŸ”´':' ğŸŸ¢'):'â€”'; pe.style.color=aProfit>0?'var(--ok)':aProfit<0?'var(--bad)':'var(--t3)'; }
  const oEl=$(`kovr-${id}`);
  if(oEl&&scores.length){
    const on=scores.filter(s=>s.ok).length,pct=Math.round((on/scores.length)*100);
    const cls=pct>=75?'ok':pct>=50?'warn':'bad',icon=pct>=75?'âœ…':pct>=50?'âš ï¸':'âŒ';
    oEl.innerHTML=`<div class="kpiovr ${cls}"><div class="kpotr">${icon} KPI Achievement: ${on}/${scores.length} on track (${pct}%)</div><button class="btn btn-sm btn-p" onclick="saveKPI('${id}')">ğŸ’¾ Save</button></div>`;
  }
}

function saveKPI(id){
  const c=DB.find(x=>x.id===id); if(!c) return;
  c.kpi.tBudget=parseFloat($(`kt-${id}-budget`)?.value)||0;
  c.actual.budget=parseFloat($(`ka-${id}-budget`)?.value)||0;
  ['imp','clk','con','roas','cpa'].forEach(m=>{
    c.kpi['t'+cap(m)]=parseFloat($(`kt-${id}-${m}`)?.value)||0;
    c.actual[m]=parseFloat($(`ka-${id}-${m}`)?.value)||0;
  });
  c.actual.rev=parseFloat($(`ka-${id}-rev`)?.value)||0;
  save(); toast('âœ… à¸šà¸±à¸™à¸—à¸¶à¸ KPI "'+c.name+'"','ok');
}

// ============================================================
// DASHBOARD
// ============================================================
function renderDash(){
  const em=$('de'),ct=$('dc');
  if(!DB.length){ em.style.display='block';ct.style.display='none'; return; }
  em.style.display='none';ct.style.display='block';
  const tot=agg();
  const avgROAS=tot.budget>0&&tot.rev>0?tot.rev/tot.budget:0;
  const avgCTR=tot.imp>0?(tot.clk/tot.imp)*100:0;
  $('dstrip').innerHTML=`
    <div class="ssi"><div class="ssv">${fc(tot.budget)}</div><div class="ssk">Total Budget</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${tot.rev>0?fc(tot.rev):'â€”'}</div><div class="ssk">Total Revenue</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${avgROAS>0?fr(avgROAS):'â€”'}</div><div class="ssk">Blended ROAS</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${fm(tot.imp)}</div><div class="ssk">Impressions</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${fm(tot.clk)}</div><div class="ssk">Clicks</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${f(tot.con,1)}</div><div class="ssk">Conversions</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${fp(avgCTR,2)}</div><div class="ssk">Avg CTR</div></div>
  `;
  Object.values(CHARTS).forEach(ch=>{ try{ch.destroy();}catch(e){} }); CHARTS={};
  const labels=DB.map(c=>c.name.length>14?c.name.slice(0,14)+'â€¦':c.name);
  const platColors={'ğŸ“˜ Facebook':'#1877F2','ğŸ” Google':'#4285F4','ğŸµ TikTok':'#FE2C55','ğŸ’š LINE':'#00B900','ğŸ“Š Media':'#8B5CF6'};
  const bgColors=DB.map(c=>platColors[TPLATFORM[c.type]]||COLORS[DB.indexOf(c)%COLORS.length]);

  const c1=$('ch1');
  if(c1) CHARTS.c1=new Chart(c1,{type:'bar',data:{labels,datasets:[{label:'Budget',data:DB.map(c=>c.inputs.budget||0),backgroundColor:bgColors,borderRadius:7,borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{ticks:{callback:v=>'à¸¿'+(v>=1000?(v/1000).toFixed(0)+'K':v)},grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  const c2=$('ch2');
  if(c2) CHARTS.c2=new Chart(c2,{type:'bar',data:{labels,datasets:[{label:'ROAS',data:DB.map(c=>c.results.roas||0),backgroundColor:DB.map(c=>(c.results.roas||0)>=3?'rgba(5,150,105,.8)':(c.results.roas||0)>=1?'rgba(217,119,6,.8)':'rgba(220,38,38,.8)'),borderRadius:7,borderWidth:0},{label:'Target 3x',data:DB.map(()=>3),type:'line',borderColor:'#EF4444',borderDash:[5,4],borderWidth:2,pointRadius:0,fill:false}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{font:{size:11}}}},scales:{y:{ticks:{callback:v=>v+'x'},beginAtZero:true,grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  const c3=$('ch3');
  if(c3) CHARTS.c3=new Chart(c3,{type:'bar',data:{labels,datasets:[{label:'Impressions',data:DB.map(c=>c.results.imp||0),backgroundColor:'rgba(59,130,246,.75)',borderRadius:5,borderWidth:0},{label:'Clicks',data:DB.map(c=>c.results.clk||0),backgroundColor:'rgba(16,185,129,.75)',borderRadius:5,borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{font:{size:11}}}},scales:{y:{ticks:{callback:v=>v>=1000?(v/1000).toFixed(0)+'K':v},grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  const c4=$('ch4');
  if(c4) CHARTS.c4=new Chart(c4,{type:'bar',data:{labels,datasets:[{label:'CPA (à¸¿)',data:DB.map(c=>c.results.cpa||0),backgroundColor:'rgba(220,38,38,.7)',borderRadius:5,borderWidth:0},{label:'Product Price (à¸¿)',data:DB.map(c=>c.inputs.productPrice||0),backgroundColor:'rgba(99,102,241,.7)',borderRadius:5,borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{font:{size:11}}}},scales:{y:{ticks:{callback:v=>'à¸¿'+v},grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  const c5=$('ch5');
  if(c5){
    const tc={};DB.forEach(c=>{const pl=TPLATFORM[c.type]||c.type;tc[pl]=(tc[pl]||0)+1;});
    const pColors={'ğŸ“˜ Facebook':'#1877F2','ğŸ” Google':'#4285F4','ğŸµ TikTok':'#FE2C55','ğŸ’š LINE':'#00B900','ğŸ“Š Media':'#8B5CF6'};
    CHARTS.c5=new Chart(c5,{type:'doughnut',data:{labels:Object.keys(tc),datasets:[{data:Object.values(tc),backgroundColor:Object.keys(tc).map(k=>pColors[k]||'#94A3B8'),borderWidth:2,borderColor:'#fff'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{font:{size:11},padding:12}}},cutout:'62%'}});
  }
}

// ============================================================
// HEADER
// ============================================================
function refreshHeader(){
  const tot=agg(), roas=tot.budget>0&&tot.rev>0?tot.rev/tot.budget:0;
  const h1=$('hs1'),h2=$('hs2'),h3=$('hs3'),h4=$('hs4');
  if(h1) h1.textContent=DB.length;
  if(h2) h2.textContent=tot.budget>=1e6?'à¸¿'+f(tot.budget/1e6,1)+'M':tot.budget>=1000?'à¸¿'+f(tot.budget/1000,1)+'K':fc(tot.budget);
  if(h3) h3.textContent=roas>0?fr(roas):'â€”';
  if(h4) h4.textContent=f(tot.con,1);
}
function refreshBadge(){ const nb=$('nc'); if(nb) nb.textContent=DB.length; }

// ============================================================
// TOAST
// ============================================================
function toast(msg,type='ok'){
  let box=$('toasts');
  const t=document.createElement('div');
  t.className='tst '+type;t.textContent=msg;box.appendChild(t);
  setTimeout(()=>{ t.style.cssText+='opacity:0;transform:translateX(16px);transition:all .25s'; setTimeout(()=>t.remove(),260); },2800);
}

// INIT
refreshHeader(); refreshBadge();
</script>
</body>
</html>
```
