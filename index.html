# ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢! üöÄ

‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå:

```html
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdMetrics Pro</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --p:#1D4ED8;--ph:#1E40AF;--pd:#1E3A8A;--pl:#EFF6FF;--pm:#DBEAFE;
  --sec:#7C3AED;--sl:#F5F3FF;
  --ok:#059669;--okl:#ECFDF5;--okm:#D1FAE5;
  --warn:#D97706;--warnl:#FFFBEB;--warnm:#FEF3C7;
  --bad:#DC2626;--badl:#FEF2F2;--badm:#FECACA;
  --bg:#F8FAFC;--bg2:#F1F5F9;--card:#fff;
  --t1:#0F172A;--t2:#334155;--t3:#64748B;
  --b1:#E2E8F0;--b2:#CBD5E1;
  --s1:0 1px 3px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);
  --s2:0 4px 6px -1px rgba(0,0,0,.06),0 2px 4px -1px rgba(0,0,0,.04);
  --s3:0 10px 20px -3px rgba(0,0,0,.07),0 4px 6px -2px rgba(0,0,0,.04);
  --r:10px;--rl:14px;--rs:6px
}
html{font-size:14px;scroll-behavior:smooth}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Noto Sans Thai',sans-serif;background:var(--bg);color:var(--t1);line-height:1.6;min-height:100vh}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--b2);border-radius:3px}

/* HEADER */
.hdr{background:linear-gradient(135deg,#1E3A8A 0%,#1D4ED8 55%,#7C3AED 100%);position:sticky;top:0;z-index:200;box-shadow:0 2px 20px rgba(29,78,216,.28)}
.hdr-in{max-width:1440px;margin:0 auto;padding:0 24px;height:62px;display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;align-items:center;gap:11px}
.brand-ico{width:38px;height:38px;border-radius:9px;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:19px;flex-shrink:0}
.brand-name{color:#fff;font-size:16px;font-weight:800;letter-spacing:-.3px;line-height:1.2}
.brand-sub{color:rgba(255,255,255,.65);font-size:9.5px;text-transform:uppercase;letter-spacing:.8px}
.hstats{display:flex;gap:24px}
.hs{text-align:center;color:#fff}
.hs-v{font-size:15px;font-weight:800;line-height:1.2}
.hs-k{font-size:9px;opacity:.65;text-transform:uppercase;letter-spacing:.7px}

/* NAV */
.nav{background:#fff;border-bottom:1px solid var(--b1);position:sticky;top:62px;z-index:199;box-shadow:var(--s1)}
.nav-in{max-width:1440px;margin:0 auto;padding:0 24px;display:flex;overflow-x:auto;scrollbar-width:none}
.nav-in::-webkit-scrollbar{display:none}
.nb{padding:0 18px;height:50px;border:none;background:none;cursor:pointer;font-size:13px;font-weight:500;color:var(--t3);display:flex;align-items:center;gap:7px;white-space:nowrap;border-bottom:2.5px solid transparent;transition:all .18s;font-family:inherit}
.nb:hover{color:var(--p);background:var(--pl)}
.nb.on{color:var(--p);border-bottom-color:var(--p);font-weight:700}
.nc{min-width:17px;height:17px;padding:0 5px;background:var(--p);color:#fff;font-size:10px;font-weight:800;border-radius:100px;display:inline-flex;align-items:center;justify-content:center}

/* MAIN */
.main{max-width:1440px;margin:0 auto;padding:26px 24px}
.sec{display:none}.sec.on{display:block;animation:fu .22s ease}
@keyframes fu{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* PAGE HEAD */
.ph{margin-bottom:26px}
.ph-row{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;flex-wrap:wrap}
.pt{font-size:22px;font-weight:800;color:var(--t1);letter-spacing:-.4px;margin-bottom:5px}
.pd{font-size:13px;color:var(--t3)}

/* CARD */
.card{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);box-shadow:var(--s1);overflow:hidden}
.cb{padding:22px}
.ch{padding:18px 22px 15px;border-bottom:1px solid var(--b1);display:flex;align-items:center;justify-content:space-between}
.ct{font-size:14px;font-weight:700;color:var(--t1);display:flex;align-items:center;gap:8px}
.cs{font-size:12px;color:var(--t3);margin-top:2px}

/* GRID */
.g2{display:grid;grid-template-columns:repeat(2,1fr);gap:22px}
.g3{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:15px}
.g5{display:grid;grid-template-columns:repeat(5,1fr);gap:14px}
.g6{display:grid;grid-template-columns:repeat(6,1fr);gap:12px}

/* FORM */
.fg{margin-bottom:14px}.fg:last-child{margin-bottom:0}
.fl{display:flex;align-items:center;gap:4px;font-size:11px;font-weight:700;color:var(--t2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:5px}
.fl .req{color:var(--bad)}
.fi{width:100%;padding:9px 12px;border:1.5px solid var(--b1);border-radius:var(--r);font-size:14px;color:var(--t1);background:#fff;transition:all .18s;font-family:inherit;outline:none}
.fi:hover{border-color:var(--b2)}
.fi:focus{border-color:var(--p);box-shadow:0 0 0 3px rgba(29,78,216,.08)}
.fi::placeholder{color:var(--b2)}
.iw{position:relative}
.iw .ipre{position:absolute;left:11px;top:50%;transform:translateY(-50%);font-size:13px;color:var(--t3);font-weight:500;pointer-events:none}
.iw .isuf{position:absolute;right:11px;top:50%;transform:translateY(-50%);font-size:13px;color:var(--t3);font-weight:500;pointer-events:none}
.iw.p .fi{padding-left:27px}
.iw.s .fi{padding-right:27px}
.fh{font-size:11px;color:var(--t3);margin-top:4px}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:9px 17px;border-radius:var(--r);font-size:13px;font-weight:600;cursor:pointer;border:none;transition:all .18s;font-family:inherit;white-space:nowrap;line-height:1}
.btn:active{transform:translateY(1px)!important}
.btn-p{background:var(--p);color:#fff}
.btn-p:hover{background:var(--ph);box-shadow:0 4px 14px rgba(29,78,216,.28);transform:translateY(-1px)}
.btn-ok{background:var(--ok);color:#fff}
.btn-ok:hover{background:#047857;box-shadow:0 4px 14px rgba(5,150,105,.24);transform:translateY(-1px)}
.btn-bad{background:var(--bad);color:#fff}
.btn-bad:hover{background:#B91C1C}
.btn-g{background:transparent;color:var(--t2);border:1.5px solid var(--b1)}
.btn-g:hover{background:var(--bg2);border-color:var(--b2)}
.btn-ol{background:transparent;color:var(--p);border:1.5px solid var(--p)}
.btn-ol:hover{background:var(--pl)}
.btn-sm{padding:6px 12px;font-size:12px;border-radius:var(--rs)}
.btn-lg{padding:11px 24px;font-size:14px}
.brow{display:flex;gap:9px;flex-wrap:wrap;align-items:center}

/* METRIC CARD */
.mc{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);padding:16px 18px;transition:all .2s;position:relative;overflow:hidden}
.mc::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--p);border-radius:var(--rl) var(--rl) 0 0}
.mc.g::before{background:var(--ok)}.mc.a::before{background:var(--warn)}.mc.v::before{background:var(--sec)}.mc.r::before{background:var(--bad)}.mc.t::before{background:#0D9488}.mc.i::before{background:#4F46E5}
.mc:hover{box-shadow:var(--s3);transform:translateY(-2px)}
.mc-lbl{font-size:11px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:7px;display:flex;align-items:center;gap:5px}
.mc-v{font-size:24px;font-weight:800;line-height:1.15;color:var(--t1);margin-bottom:4px;font-variant-numeric:tabular-nums}
.mc-v.b{color:var(--p)}.mc-v.g{color:var(--ok)}.mc-v.a{color:var(--warn)}.mc-v.v{color:var(--sec)}.mc-v.r{color:var(--bad)}.mc-v.t{color:#0D9488}
.mc-sub{font-size:11px;color:var(--t3)}
.mc-bg-b{background:linear-gradient(135deg,#EFF6FF,#DBEAFE);border-color:#BFDBFE}
.mc-bg-g{background:linear-gradient(135deg,#F0FDF4,#D1FAE5);border-color:#A7F3D0}
.mc-bg-a{background:linear-gradient(135deg,#FEFCE8,#FEF3C7);border-color:#FDE68A}
.mc-bg-v{background:linear-gradient(135deg,#F5F3FF,#EDE9FE);border-color:#DDD6FE}
.mc-bg-t{background:linear-gradient(135deg,#F0FDFA,#CCFBF1);border-color:#99F6E4}
.mc-bg-r{background:linear-gradient(135deg,#FFF1F2,#FFE4E6);border-color:#FECDD3}

/* RESULT BOX */
.rbox{background:linear-gradient(135deg,#F0F7FF,#F5F0FF);border:1px solid #C7D2FE;border-radius:var(--rl);padding:22px}
.rtitle{font-size:11px;font-weight:800;color:var(--p);text-transform:uppercase;letter-spacing:.8px;margin-bottom:16px;display:flex;align-items:center;gap:7px}

/* FORMULA */
.frmbox{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r);padding:13px 15px;font-size:12px;color:var(--t2);line-height:2.1}
.frmbox code{background:#fff;color:var(--p);font-family:'Consolas','Monaco',monospace;font-size:11px;padding:2px 6px;border-radius:4px;border:1px solid var(--b1)}

/* BADGE */
.bdg{display:inline-flex;align-items:center;padding:2px 8px;border-radius:100px;font-size:11px;font-weight:700}
.bdg-b{background:#DBEAFE;color:#1E40AF}.bdg-g{background:#D1FAE5;color:#065F46}
.bdg-a{background:#FEF3C7;color:#92400E}.bdg-v{background:#EDE9FE;color:#5B21B6}
.bdg-r{background:#FFE4E6;color:#9F1239}.bdg-t{background:#CCFBF1;color:#134E4A}
.bdg-gr{background:var(--bg2);color:var(--t3)}

/* PROGRESS */
.prw{margin-bottom:2px}
.pri{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}
.prl{font-size:12px;font-weight:600;color:var(--t2)}
.prp{font-size:12px;font-weight:700}
.prt{height:7px;background:var(--bg2);border-radius:100px;overflow:hidden}
.prf{height:100%;border-radius:100px;transition:width .55s cubic-bezier(.4,0,.2,1)}
.prf.b{background:linear-gradient(90deg,var(--p),#60A5FA)}
.prf.g{background:linear-gradient(90deg,var(--ok),#34D399)}
.prf.a{background:linear-gradient(90deg,var(--warn),#FBBF24)}
.prf.r{background:linear-gradient(90deg,var(--bad),#F87171)}
.prs{font-size:10px;color:var(--t3);margin-top:3px;display:flex;align-items:center;gap:4px}

/* TABLE */
.tw{overflow-x:auto;border-radius:var(--rl);border:1px solid var(--b1)}
table{width:100%;border-collapse:collapse}
thead th{padding:11px 15px;text-align:left;font-size:11px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;background:var(--bg2);border-bottom:1px solid var(--b1);white-space:nowrap}
tbody td{padding:13px 15px;border-bottom:1px solid var(--b1);color:var(--t1);vertical-align:middle}
tbody tr:last-child td{border-bottom:none}
tbody tr:hover td{background:var(--pl)}
.tn{font-weight:700;font-size:13px}.tnm{font-size:11px;color:var(--t3);margin-top:2px}
.tv{font-weight:600;color:var(--p);font-variant-numeric:tabular-nums;font-size:13px}

/* SUB TABS */
.str{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:22px}
.st{padding:7px 15px;border-radius:100px;border:1.5px solid var(--b1);background:#fff;font-size:12px;font-weight:600;color:var(--t3);cursor:pointer;transition:all .18s;font-family:inherit}
.st:hover{border-color:var(--p);color:var(--p);background:var(--pl)}
.st.on{background:var(--p);color:#fff;border-color:var(--p)}

/* DIV */
.dv{height:1px;background:var(--b1);margin:18px 0}

/* EMPTY */
.emp{text-align:center;padding:60px 20px;display:flex;flex-direction:column;align-items:center;gap:11px}
.emp-i{font-size:48px;line-height:1}
.emp-t{font-size:16px;font-weight:700;color:var(--t2)}
.emp-d{font-size:13px;color:var(--t3);max-width:350px;line-height:1.7}

/* TOOLTIP */
.tip{position:relative;display:inline-flex;align-items:center}
.tip-i{width:14px;height:14px;background:var(--b1);border-radius:50%;font-size:9px;color:var(--t3);cursor:help;display:inline-flex;align-items:center;justify-content:center;margin-left:4px;flex-shrink:0;font-style:italic;font-weight:700}
.tip-t{display:none;position:absolute;bottom:130%;left:50%;transform:translateX(-50%);background:#0F172A;color:#fff;font-size:11px;padding:7px 11px;border-radius:7px;min-width:170px;max-width:220px;text-align:center;z-index:500;line-height:1.5;pointer-events:none;font-weight:400;box-shadow:0 4px 12px rgba(0,0,0,.2)}
.tip-t::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border:5px solid transparent;border-top-color:#0F172A}
.tip:hover .tip-t{display:block}

/* KPI CARD */
.kpic{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);margin-bottom:18px;box-shadow:var(--s1);overflow:hidden}
.kpih{background:linear-gradient(135deg,#1E3A8A,#1D4ED8 55%,#7C3AED);padding:17px 22px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px}
.kpin{font-size:15px;font-weight:800;color:#fff}
.kpim{font-size:11px;color:rgba(255,255,255,.7);margin-top:2px}
.kpib{padding:18px 22px}

/* KPI metric item */
.kmi{background:var(--bg);border:1px solid var(--b1);border-radius:var(--r);padding:14px}
.kmit{font-size:10px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:10px}
.kmi-g{display:grid;grid-template-columns:1fr 1fr;gap:7px;margin-bottom:8px}
.kmi-g .fg{margin:0}
.kmi-g .fl{font-size:9px;letter-spacing:.3px}
.kmi-g .fi{padding:6px 10px;font-size:12px}

/* Overall KPI */
.kpiovr{border-radius:var(--r);padding:13px 16px;display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap;margin-top:14px;border:1px solid}
.kpiovr.ok{background:var(--okl);border-color:#A7F3D0}
.kpiovr.warn{background:var(--warnl);border-color:#FDE68A}
.kpiovr.bad{background:var(--badl);border-color:#FECACA}
.kpotr{font-size:13px;font-weight:700}
.kpiovr.ok .kpotr{color:var(--ok)}.kpiovr.warn .kpotr{color:var(--warn)}.kpiovr.bad .kpotr{color:var(--bad)}

/* CHART CARD */
.chc{background:#fff;border:1px solid var(--b1);border-radius:var(--rl);padding:20px;box-shadow:var(--s1)}
.cht{font-size:14px;font-weight:700;color:var(--t1);margin-bottom:3px}
.chs{font-size:11px;color:var(--t3);margin-bottom:16px}
.chw{position:relative;height:230px}

/* SUMMARY STRIP */
.sstrip{background:linear-gradient(135deg,var(--pd),var(--p) 50%,var(--sec));border-radius:var(--rl);padding:18px 26px;display:flex;align-items:center;gap:24px;flex-wrap:wrap;margin-bottom:22px}
.ssi{color:#fff;flex:1;min-width:90px}
.ssv{font-size:21px;font-weight:800;line-height:1.2}
.ssk{font-size:9px;opacity:.7;text-transform:uppercase;letter-spacing:.7px}
.ssdv{width:1px;height:36px;background:rgba(255,255,255,.2)}

/* TOAST */
#toasts{position:fixed;bottom:22px;right:22px;z-index:9999;display:flex;flex-direction:column-reverse;gap:8px;pointer-events:none}
.tst{padding:10px 15px;border-radius:10px;font-size:13px;font-weight:600;box-shadow:0 4px 16px rgba(0,0,0,.12);max-width:300px;animation:si .22s ease;pointer-events:auto;display:flex;align-items:center;gap:8px}
.tst.ok{background:#F0FDF4;border:1px solid #BBF7D0;color:#065F46}
.tst.warn{background:var(--warnl);border:1px solid #FDE68A;color:#92400E}
.tst.bad{background:var(--badl);border:1px solid #FECACA;color:#991B1B}
@keyframes si{from{opacity:0;transform:translateX(18px)}to{opacity:1;transform:translateX(0)}}

/* SPACING */
.mb3{margin-bottom:12px}.mb4{margin-bottom:16px}.mb6{margin-bottom:24px}.mt4{margin-top:16px}.mt6{margin-top:24px}

/* RESPONSIVE */
@media(max-width:1100px){.g5{grid-template-columns:repeat(3,1fr)}}
@media(max-width:900px){.g4{grid-template-columns:repeat(2,1fr)}.g6{grid-template-columns:repeat(3,1fr)}}
@media(max-width:700px){
  .hstats{display:none}.main{padding:16px}
  .g2,.g3,.g4,.g5,.g6{grid-template-columns:1fr}
  .pt{font-size:19px}.sstrip{flex-direction:column;padding:16px 18px}
  .ssdv{width:36px;height:1px}.mc-v{font-size:20px}
  .kpib{padding:14px 16px}.kpih{padding:14px 16px}
  .kmi-g{grid-template-columns:1fr}
}
@media(max-width:480px){.cb{padding:15px}.ch{padding:14px 15px 12px}}
</style>
</head>
<body>
<div id="toasts"></div>

<!-- HEADER -->
<header class="hdr">
  <div class="hdr-in">
    <div class="brand">
      <div class="brand-ico">üìä</div>
      <div><div class="brand-name">AdMetrics Pro</div><div class="brand-sub">Media Buying & Performance Calculator</div></div>
    </div>
    <div class="hstats">
      <div class="hs"><div class="hs-v" id="hs1">0</div><div class="hs-k">Campaigns</div></div>
      <div class="hs"><div class="hs-v" id="hs2">‡∏ø0</div><div class="hs-k">Total Budget</div></div>
      <div class="hs"><div class="hs-v" id="hs3">‚Äî</div><div class="hs-k">Avg ROAS</div></div>
      <div class="hs"><div class="hs-v" id="hs4">0</div><div class="hs-k">Conversions</div></div>
    </div>
  </div>
</header>

<!-- NAV -->
<nav class="nav">
  <div class="nav-in">
    <button class="nb on" onclick="goTab('calc')">üßÆ Media Buying</button>
    <button class="nb" onclick="goTab('fb')">üìò Facebook Ads</button>
    <button class="nb" onclick="goTab('camps')">üìã Campaigns <span class="nc" id="nc">0</span></button>
    <button class="nb" onclick="goTab('kpi')">üéØ KPI Tracking</button>
    <button class="nb" onclick="goTab('dash')">üìà Dashboard</button>
  </div>
</nav>

<main class="main">

<!-- =================== TAB: MEDIA BUYING =================== -->
<section id="t-calc" class="sec on">
  <div class="ph">
    <div class="pt">Media Buying Calculator</div>
    <div class="pd">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Impressions, Clicks, Conversions, CPA ‡πÅ‡∏•‡∏∞ ROAS ‡∏à‡∏≤‡∏Å‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç</div>
  </div>
  <div class="g2">
    <!-- INPUTS -->
    <div>
      <div class="card">
        <div class="ch"><div><div class="ct">‚öôÔ∏è Campaign Setup</div><div class="cs">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</div></div></div>
        <div class="cb">
          <div class="fg">
            <label class="fl">Campaign Name <span class="req">*</span></label>
            <input class="fi" id="cn" type="text" placeholder="e.g. Q2 Brand Campaign 2025">
          </div>
          <div class="g2">
            <div class="fg">
              <label class="fl">Budget <span class="tip"><span class="tip-i">i</span><span class="tip-t">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç (‡∏ö‡∏≤‡∏ó)</span></span></label>
              <div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="cb2" type="number" min="0" placeholder="50,000" oninput="calcM()"></div>
            </div>
            <div class="fg">
              <label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">Cost per Mille ‚Äî ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• 1,000 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span></span></label>
              <div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="ccpm" type="number" min="0" step=".1" placeholder="80" oninput="calcM()"></div>
            </div>
            <div class="fg">
              <label class="fl">CPC <span class="tip"><span class="tip-i">i</span><span class="tip-t">Cost per Click ‚Äî ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠ 1 ‡∏Ñ‡∏•‡∏¥‡∏Å</span></span></label>
              <div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="ccpc" type="number" min="0" step=".01" placeholder="5.00" oninput="calcM()"></div>
            </div>
            <div class="fg">
              <label class="fl">CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">Conversion Rate ‚Äî % ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span></span></label>
              <div class="iw s"><input class="fi" id="ccvr" type="number" min="0" max="100" step=".01" placeholder="2.50" oninput="calcM()"><span class="isuf">%</span></div>
            </div>
          </div>
          <div class="fg">
            <label class="fl">Product Price / Unit <span class="tip"><span class="tip-i">i</span><span class="tip-t">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠ 1 ‡∏ä‡∏¥‡πâ‡∏ô ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Revenue ‡πÅ‡∏•‡∏∞ ROAS</span></span></label>
            <div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="cprc" type="number" min="0" placeholder="990" oninput="calcM()"></div>
          </div>
          <div class="frmbox mt4">
            üìê <strong style="color:var(--p)">Formulas:</strong><br>
            <code>Impressions = (Budget √∑ CPM) √ó 1,000</code> | <code>Clicks = Budget √∑ CPC</code><br>
            <code>Conversions = Clicks √ó CVR%</code> | <code>CPA = Budget √∑ Conversions</code><br>
            <code>Revenue = Conversions √ó Price</code> | <code>ROAS = Revenue √∑ Budget</code>
          </div>
          <div class="brow mt4">
            <button class="btn btn-p btn-lg" onclick="saveM()">üíæ Save Campaign</button>
            <button class="btn btn-g" onclick="clearM()">üîÑ Reset</button>
          </div>
        </div>
      </div>
    </div>
    <!-- RESULTS -->
    <div>
      <div class="rbox">
        <div class="rtitle">‚ú® Calculated Results</div>
        <div class="g2 mb4">
          <div class="mc mc-bg-b"><div class="mc-lbl">üëÅÔ∏è Impressions</div><div class="mc-v b" id="ri">‚Äî</div><div class="mc-sub">‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">üñ±Ô∏è Clicks</div><div class="mc-v g" id="rc">‚Äî</div><div class="mc-sub">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å</div></div>
          <div class="mc mc-bg-v"><div class="mc-lbl">üéØ Conversions</div><div class="mc-v v" id="rv">‚Äî</div><div class="mc-sub">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Conversion</div></div>
          <div class="mc mc-bg-a"><div class="mc-lbl">üí∞ CPA</div><div class="mc-v a" id="rpa">‚Äî</div><div class="mc-sub">Cost per Acquisition</div></div>
        </div>
        <div class="g3 mb4">
          <div class="mc mc-bg-t"><div class="mc-lbl">üì¶ Revenue</div><div class="mc-v t" id="rrev">‚Äî</div><div class="mc-sub">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">üìà ROAS</div><div class="mc-v g" id="rroas">‚Äî</div><div class="mc-sub">Return on Ad Spend</div></div>
          <div class="mc" id="rpc2"><div class="mc-lbl">üíµ Gross Profit</div><div class="mc-v" id="rpro">‚Äî</div><div class="mc-sub">Revenue ‚àí Budget</div></div>
        </div>
        <div class="g3">
          <div style="background:#fff;border:1px solid var(--b1);border-radius:var(--r);padding:12px;text-align:center">
            <div class="mc-lbl" style="justify-content:center;margin-bottom:5px">CTR</div>
            <div style="font-size:19px;font-weight:800;color:var(--p)" id="rctr">‚Äî</div>
            <div class="mc-sub">Click-Through Rate</div>
          </div>
          <div style="background:#fff;border:1px solid var(--b1);border-radius:var(--r);padding:12px;text-align:center">
            <div class="mc-lbl" style="justify-content:center;margin-bottom:5px">eCPM</div>
            <div style="font-size:19px;font-weight:800;color:var(--sec)" id="recpm">‚Äî</div>
            <div class="mc-sub">Effective CPM</div>
          </div>
          <div style="background:#fff;border:1px solid var(--b1);border-radius:var(--r);padding:12px;text-align:center">
            <div class="mc-lbl" style="justify-content:center;margin-bottom:5px">Rev/Conv</div>
            <div style="font-size:19px;font-weight:800;color:var(--ok)" id="rrpc">‚Äî</div>
            <div class="mc-sub">Revenue per Conv.</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- =================== TAB: FACEBOOK ADS =================== -->
<section id="t-fb" class="sec">
  <div class="ph">
    <div class="pt">Facebook Ads Calculator</div>
    <div class="pd">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç Facebook ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° Objective</div>
  </div>
  <div class="str">
    <button class="st on" onclick="fbTab('like')">üëç Page Like</button>
    <button class="st" onclick="fbTab('eng')">üí¨ Engagement</button>
    <button class="st" onclick="fbTab('lead')">üìã Lead Ads</button>
    <button class="st" onclick="fbTab('vid')">üé¨ Video View</button>
  </div>

  <!-- PAGE LIKE -->
  <div id="fb-like" class="fb-p">
    <div class="g2">
      <div class="card">
        <div class="ch"><div><div class="ct">üëç Page Like Ads</div><div class="cs">‡πÄ‡∏û‡∏¥‡πà‡∏° Page Followers</div></div></div>
        <div class="cb">
          <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fln" type="text" placeholder="Page Like Campaign Q2"></div>
          <div class="g2">
            <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="flb" type="number" min="0" placeholder="10,000" oninput="calcLike()"></div></div>
            <div class="fg"><label class="fl">CPM <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. ‡∏ø40‚Äì80</span></span></label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="flcpm" type="number" min="0" placeholder="50" oninput="calcLike()"></div></div>
            <div class="fg"><label class="fl">Cost per Like (Target) <span class="tip"><span class="tip-i">i</span><span class="tip-t">avg. ‡∏ø1‚Äì5 ‡∏ï‡πà‡∏≠ Like</span></span></label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="flcpl" type="number" min="0" step=".1" placeholder="2.50" oninput="calcLike()"></div></div>
            <div class="fg"><label class="fl">Like Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡πâ‡∏ß Like Page</span></span></label><div class="iw s"><input class="fi" id="flr" type="number" min="0" max="100" step=".1" placeholder="1.5" oninput="calcLike()"><span class="isuf">%</span></div></div>
          </div>
          <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_page_like','fln')">üíæ Save</button><button class="btn btn-g" onclick="clearFb(['flb','flcpm','flcpl','flr'])">üîÑ Clear</button></div>
        </div>
      </div>
      <div class="rbox">
        <div class="rtitle">üìä Page Like Results</div>
        <div class="g2">
          <div class="mc mc-bg-b"><div class="mc-lbl">üëÅÔ∏è Impressions</div><div class="mc-v b" id="flri">‚Äî</div></div>
          <div class="mc mc-bg-t"><div class="mc-lbl">üë• Est. Reach</div><div class="mc-v t" id="flrr">‚Äî</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">üëç Page Likes</div><div class="mc-v g" id="flrl">‚Äî</div></div>
          <div class="mc mc-bg-a"><div class="mc-lbl">üí∞ Actual CPL</div><div class="mc-v a" id="flrc">‚Äî</div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ENGAGEMENT -->
  <div id="fb-eng" class="fb-p" style="display:none">
    <div class="g2">
      <div class="card">
        <div class="ch"><div><div class="ct">üí¨ Engagement Ads</div><div class="cs">Post Likes, Comments, Shares</div></div></div>
        <div class="cb">
          <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fen" type="text" placeholder="Engagement Campaign Q2"></div>
          <div class="g2">
            <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="feb" type="number" min="0" placeholder="20,000" oninput="calcEng()"></div></div>
            <div class="fg"><label class="fl">CPM</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fecpm" type="number" min="0" placeholder="60" oninput="calcEng()"></div></div>
            <div class="fg"><label class="fl">CPE <span class="tip"><span class="tip-i">i</span><span class="tip-t">Cost per Engagement avg. ‡∏ø0.5‚Äì3</span></span></label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fecpe" type="number" min="0" step=".1" placeholder="1.50" oninput="calcEng()"></div></div>
            <div class="fg"><label class="fl">Engagement Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡πâ‡∏ß Interact</span></span></label><div class="iw s"><input class="fi" id="fer" type="number" min="0" max="100" step=".1" placeholder="3.0" oninput="calcEng()"><span class="isuf">%</span></div></div>
          </div>
          <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_engagement','fen')">üíæ Save</button><button class="btn btn-g" onclick="clearFb(['feb','fecpm','fecpe','fer'])">üîÑ Clear</button></div>
        </div>
      </div>
      <div class="rbox">
        <div class="rtitle">üìä Engagement Results</div>
        <div class="g2">
          <div class="mc mc-bg-b"><div class="mc-lbl">üëÅÔ∏è Impressions</div><div class="mc-v b" id="feri">‚Äî</div></div>
          <div class="mc mc-bg-t"><div class="mc-lbl">üë• Reach</div><div class="mc-v t" id="ferr">‚Äî</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">üí¨ Engagements</div><div class="mc-v g" id="fere">‚Äî</div></div>
          <div class="mc mc-bg-a"><div class="mc-lbl">üí∞ Actual CPE</div><div class="mc-v a" id="ferc">‚Äî</div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- LEAD ADS -->
  <div id="fb-lead" class="fb-p" style="display:none">
    <div class="g2">
      <div class="card">
        <div class="ch"><div><div class="ct">üìã Lead Ads</div><div class="cs">Facebook Instant Lead Form</div></div></div>
        <div class="cb">
          <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fldn" type="text" placeholder="Lead Gen Campaign Q2"></div>
          <div class="g2">
            <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fldb" type="number" min="0" placeholder="30,000" oninput="calcLead()"></div></div>
            <div class="fg"><label class="fl">CPM</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fldcpm" type="number" min="0" placeholder="80" oninput="calcLead()"></div></div>
            <div class="fg"><label class="fl">CTR <span class="tip"><span class="tip-i">i</span><span class="tip-t">% ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ avg. 0.5‚Äì2.5%</span></span></label><div class="iw s"><input class="fi" id="fldctr" type="number" min="0" max="100" step=".1" placeholder="1.5" oninput="calcLead()"><span class="isuf">%</span></div></div>
            <div class="fg"><label class="fl">Form Fill Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å Lead Form avg. 10‚Äì30%</span></span></label><div class="iw s"><input class="fi" id="fldf" type="number" min="0" max="100" step="1" placeholder="20" oninput="calcLead()"><span class="isuf">%</span></div></div>
            <div class="fg"><label class="fl">Product Price / Unit</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fldp" type="number" min="0" placeholder="2,500" oninput="calcLead()"></div></div>
            <div class="fg"><label class="fl">Lead ‚Üí Sale CVR <span class="tip"><span class="tip-i">i</span><span class="tip-t">% ‡∏Ç‡∏≠‡∏á Lead ‡∏ó‡∏µ‡πà‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ</span></span></label><div class="iw s"><input class="fi" id="fldcvr" type="number" min="0" max="100" step="1" placeholder="15" oninput="calcLead()"><span class="isuf">%</span></div></div>
          </div>
          <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_lead','fldn')">üíæ Save</button><button class="btn btn-g" onclick="clearFb(['fldb','fldcpm','fldctr','fldf','fldp','fldcvr'])">üîÑ Clear</button></div>
        </div>
      </div>
      <div class="rbox">
        <div class="rtitle">üìä Lead Gen Results</div>
        <div class="g2">
          <div class="mc mc-bg-b"><div class="mc-lbl">üëÅÔ∏è Impressions</div><div class="mc-v b" id="fldri">‚Äî</div></div>
          <div class="mc mc-bg-t"><div class="mc-lbl">üñ±Ô∏è Clicks</div><div class="mc-v t" id="fldrc">‚Äî</div></div>
          <div class="mc mc-bg-v"><div class="mc-lbl">üìã Leads</div><div class="mc-v v" id="fldrl">‚Äî</div></div>
          <div class="mc mc-bg-a"><div class="mc-lbl">üí∞ Cost per Lead</div><div class="mc-v a" id="fldra">‚Äî</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">üéØ Sales</div><div class="mc-v g" id="fldrs">‚Äî</div></div>
          <div class="mc mc-bg-t"><div class="mc-lbl">üìà ROAS</div><div class="mc-v t" id="fldrr">‚Äî</div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- VIDEO -->
  <div id="fb-vid" class="fb-p" style="display:none">
    <div class="g2">
      <div class="card">
        <div class="ch"><div><div class="ct">üé¨ Video View Ads</div><div class="cs">ThruPlay / 2-Second Video Views</div></div></div>
        <div class="cb">
          <div class="fg"><label class="fl">Campaign Name</label><input class="fi" id="fvn" type="text" placeholder="Video Campaign Q2"></div>
          <div class="g2">
            <div class="fg"><label class="fl">Budget</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fvb" type="number" min="0" placeholder="15,000" oninput="calcVid()"></div></div>
            <div class="fg"><label class="fl">CPM</label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fvcpm" type="number" min="0" placeholder="55" oninput="calcVid()"></div></div>
            <div class="fg"><label class="fl">2-Sec View Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% ‡∏ó‡∏µ‡πà‡∏î‡∏π VDO ‚â• 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ avg. 20‚Äì50%</span></span></label><div class="iw s"><input class="fi" id="fv2" type="number" min="0" max="100" step="1" placeholder="35" oninput="calcVid()"><span class="isuf">%</span></div></div>
            <div class="fg"><label class="fl">ThruPlay Rate <span class="tip"><span class="tip-i">i</span><span class="tip-t">% ‡∏ó‡∏µ‡πà‡∏î‡∏π‡∏à‡∏ô‡∏à‡∏ö‡∏´‡∏£‡∏∑‡∏≠ ‚â• 15 ‡∏ß‡∏¥ avg. 5‚Äì15%</span></span></label><div class="iw s"><input class="fi" id="fvt" type="number" min="0" max="100" step="1" placeholder="10" oninput="calcVid()"><span class="isuf">%</span></div></div>
            <div class="fg"><label class="fl">CPV Target <span class="tip"><span class="tip-i">i</span><span class="tip-t">Cost per ThruPlay ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ avg. ‡∏ø0.5‚Äì2</span></span></label><div class="iw p"><span class="ipre">‡∏ø</span><input class="fi" id="fvcpv" type="number" min="0" step=".1" placeholder="1.00" oninput="calcVid()"></div></div>
          </div>
          <div class="brow mt4"><button class="btn btn-p" onclick="saveFb('fb_video','fvn')">üíæ Save</button><button class="btn btn-g" onclick="clearFb(['fvb','fvcpm','fv2','fvt','fvcpv'])">üîÑ Clear</button></div>
        </div>
      </div>
      <div class="rbox">
        <div class="rtitle">üìä Video View Results</div>
        <div class="g2">
          <div class="mc mc-bg-b"><div class="mc-lbl">üëÅÔ∏è Impressions</div><div class="mc-v b" id="fvri">‚Äî</div></div>
          <div class="mc mc-bg-g"><div class="mc-lbl">‚ñ∂Ô∏è 2-Sec Views</div><div class="mc-v g" id="fvr2">‚Äî</div></div>
          <div class="mc mc-bg-v"><div class="mc-lbl">üì∫ ThruPlays</div><div class="mc-v v" id="fvrt">‚Äî</div></div>
          <div class="mc mc-bg-a"><div class="mc-lbl">üí∞ Cost/ThruPlay</div><div class="mc-v a" id="fvrc">‚Äî</div></div>
          <div class="mc mc-bg-t"><div class="mc-lbl">üìä ThruPlay Rate</div><div class="mc-v t" id="fvrr">‚Äî</div></div>
          <div class="mc mc-bg-r"><div class="mc-lbl">üíµ eCPM</div><div class="mc-v r" id="fvre">‚Äî</div></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- =================== TAB: CAMPAIGNS =================== -->
<section id="t-camps" class="sec">
  <div class="ph-row mb6">
    <div><div class="pt">Campaign Manager</div><div class="pd">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div></div>
    <div class="brow">
      <button class="btn btn-ok" onclick="exportCSV()">üì• Export CSV</button>
      <button class="btn btn-g btn-sm" onclick="clearAll()">üóëÔ∏è Clear All</button>
    </div>
  </div>
  <div id="ce" class="card"><div class="emp"><div class="emp-i">üì≠</div><div class="emp-t">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç</div><div class="emp-d">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Media Buying ‡∏´‡∏£‡∏∑‡∏≠ Facebook Ads ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Save</div></div></div>
  <div id="cc" style="display:none">
    <div class="g4 mb6" id="cs2"></div>
    <div class="card">
      <div class="ch"><div class="ct">üìã All Campaigns</div><div style="font-size:12px;color:var(--t3)" id="ccount">0</div></div>
      <div class="tw">
        <table>
          <thead><tr><th>Campaign</th><th>Type</th><th>Budget</th><th>Impressions</th><th>Clicks</th><th>CTR</th><th>Conversions</th><th>CVR</th><th>CPA</th><th>Revenue</th><th>ROAS</th><th>Actions</th></tr></thead>
          <tbody id="ctbl"></tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<!-- =================== TAB: KPI =================== -->
<section id="t-kpi" class="sec">
  <div class="ph"><div class="pt">üéØ KPI Tracking ‚Äî Actual vs Target</div><div class="pd">‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ KPI ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç</div></div>
  <div id="ke" class="card"><div class="emp"><div class="emp-i">üéØ</div><div class="emp-t">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö KPI</div><div class="emp-d">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏±‡πâ‡∏á Target ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å Actual ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div></div></div>
  <div id="kc"></div>
</section>

<!-- =================== TAB: DASHBOARD =================== -->
<section id="t-dash" class="sec">
  <div class="ph"><div class="pt">üìà Performance Dashboard</div><div class="pd">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div></div>
  <div id="de" class="card"><div class="emp"><div class="emp-i">üìä</div><div class="emp-t">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard</div><div class="emp-d">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç</div></div></div>
  <div id="dc" style="display:none">
    <div class="sstrip" id="dstrip"></div>
    <div class="g2 mb6">
      <div class="chc"><div class="cht">Budget Allocation</div><div class="chs">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç (‡∏ø)</div><div class="chw"><canvas id="ch1"></canvas></div></div>
      <div class="chc"><div class="cht">ROAS Comparison</div><div class="chs">Return on Ad Spend ‚Äî ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏î‡∏á = Target 3x</div><div class="chw"><canvas id="ch2"></canvas></div></div>
    </div>
    <div class="g3 mb6">
      <div class="chc"><div class="cht">Impressions vs Clicks</div><div class="chs">‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• & ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</div><div class="chw"><canvas id="ch3"></canvas></div></div>
      <div class="chc"><div class="cht">CPA vs Product Price</div><div class="chs">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠ Conversion vs ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div><div class="chw"><canvas id="ch4"></canvas></div></div>
      <div class="chc"><div class="cht">Campaign Type Mix</div><div class="chs">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç</div><div class="chw"><canvas id="ch5"></canvas></div></div>
    </div>
    <div class="card" id="kdash" style="display:none">
      <div class="ch"><div class="ct">üéØ KPI Achievement Summary</div></div>
      <div class="cb" id="kdashb"></div>
    </div>
  </div>
</section>

</main>

<script>
// ============================================================
// DATA
// ============================================================
let DB = JSON.parse(localStorage.getItem('adm3') || '[]');
let CHARTS = {};

const TMAP = {media_buying:'Media Buying',fb_page_like:'FB Page Like',fb_engagement:'FB Engagement',fb_lead:'FB Lead Ads',fb_video:'FB Video'};
const TBDG = {media_buying:'bdg-b',fb_page_like:'bdg-g',fb_engagement:'bdg-a',fb_lead:'bdg-v',fb_video:'bdg-r'};
const COLORS = ['#3B82F6','#8B5CF6','#10B981','#F59E0B','#EF4444','#06B6D4','#EC4899','#F97316','#14B8A6','#6366F1'];

// ============================================================
// UTILS
// ============================================================
const G = id => { const e = document.getElementById(id); return e ? parseFloat(e.value)||0 : 0; };
const GS = id => { const e = document.getElementById(id); return e ? e.value.trim() : ''; };
const $ = id => document.getElementById(id);
const SET = (id,v) => { const e=$(id); if(e) e.textContent=v; };

function f(n,d=0){ if(!isFinite(n)||isNaN(n)) return '‚Äî'; return Number(n).toLocaleString('th-TH',{minimumFractionDigits:d,maximumFractionDigits:d}); }
function fc(n,d=0){ return isFinite(n)&&!isNaN(n)&&n>0 ? '‡∏ø'+f(n,d) : n===0?'‡∏ø0':'‚Äî'; }
function fp(n,d=2){ return isFinite(n)&&!isNaN(n) ? f(n,d)+'%' : '‚Äî'; }
function fr(n){ return isFinite(n)&&!isNaN(n)&&n>0 ? f(n,2)+'x' : '‚Äî'; }
function fm(n){ if(!isFinite(n)||isNaN(n)) return '‚Äî'; if(n>=1e6) return f(n/1e6,2)+'M'; if(n>=1000) return f(n/1000,1)+'K'; return f(n,0); }
function uid(){ return Date.now().toString(36)+Math.random().toString(36).slice(2,6); }
function esc(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function save(){
  localStorage.setItem('adm3',JSON.stringify(DB));
  refreshHeader(); refreshBadge();
}

// ============================================================
// NAVIGATION
// ============================================================
function goTab(tab){
  document.querySelectorAll('.sec').forEach(s=>s.classList.remove('on'));
  document.querySelectorAll('.nb').forEach(b=>b.classList.remove('on'));
  $('t-'+tab)?.classList.add('on');
  const tabs=['calc','fb','camps','kpi','dash'];
  document.querySelectorAll('.nb')[tabs.indexOf(tab)]?.classList.add('on');
  if(tab==='camps') renderCamps();
  if(tab==='kpi') renderKPI();
  if(tab==='dash') renderDash();
}

function fbTab(tab){
  document.querySelectorAll('.fb-p').forEach(p=>p.style.display='none');
  document.querySelectorAll('.st').forEach(b=>b.classList.remove('on'));
  $('fb-'+tab).style.display='block';
  ['like','eng','lead','vid'].forEach((t,i)=>{ if(t===tab) document.querySelectorAll('.st')[i]?.classList.add('on'); });
}

// ============================================================
// MEDIA BUYING CALC
// ============================================================
function calcM(){
  const b=G('cb2'),cpm=G('ccpm'),cpc=G('ccpc'),cvr=G('ccvr')/100,prc=G('cprc');
  if(!b){ ['ri','rc','rv','rpa','rrev','rroas','rpro','rctr','recpm','rrpc'].forEach(id=>SET(id,'‚Äî')); return; }
  const imp = cpm>0 ? (b/cpm)*1000 : 0;
  const clk = cpc>0 ? b/cpc : 0;
  const con = clk*cvr;
  const cpa = con>0 ? b/con : 0;
  const rev = con*prc;
  const roas = b>0&&rev>0 ? rev/b : 0;
  const ctr = imp>0 ? (clk/imp)*100 : 0;
  const ecpm = imp>0 ? (b/imp)*1000 : 0;
  const profit = rev-b;
  SET('ri',fm(imp)); SET('rc',fm(clk)); SET('rv',f(con,1));
  SET('rpa',cpa>0?fc(cpa,2):'‚Äî'); SET('rrev',rev>0?fc(rev):'‚Äî');
  SET('rroas',roas>0?fr(roas):'‚Äî');
  SET('rctr',imp>0?fp(ctr,3):'‚Äî'); SET('recpm',ecpm>0?fc(ecpm,2):'‚Äî');
  SET('rrpc',prc>0?fc(prc):'‚Äî');
  const pe=$('rpro');
  if(pe){ pe.textContent=rev>0?fc(Math.abs(profit))+(profit<0?' (‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô)':''):'‚Äî'; pe.style.color=profit>=0?'var(--ok)':'var(--bad)'; }
  const pc=$('rpc2');
  if(pc&&rev>0){ pc.className='mc '+(profit>=0?'mc-bg-g g':'mc-bg-r r'); }
}

function clearM(){
  ['cn','cb2','ccpm','ccpc','ccvr','cprc'].forEach(id=>{ const e=$(id);if(e)e.value=''; });
  calcM();
}

function saveM(){
  const name=GS('cn')||'Campaign '+(DB.length+1);
  const b=G('cb2'); if(!b){ toast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Budget','warn'); return; }
  const cpm=G('ccpm'),cpc=G('ccpc'),cvr=G('ccvr'),prc=G('cprc');
  const cvrD=cvr/100;
  const imp=cpm>0?(b/cpm)*1000:0;
  const clk=cpc>0?b/cpc:0;
  const con=clk*cvrD;
  const cpa=con>0?b/con:0;
  const rev=con*prc;
  const roas=b>0&&rev>0?rev/b:0;
  const ctr=imp>0?(clk/imp)*100:0;
  DB.push({
    id:uid(),name,type:'media_buying',
    inputs:{budget:b,cpm,cpc,cvr,productPrice:prc},
    results:{imp,clk,con,cpa,rev,roas,ctr},
    kpi:{tBudget:b,tImp:0,tClk:0,tCon:0,tROAS:0,tCPA:0},
    actual:{budget:0,imp:0,clk:0,con:0,rev:0},
    at:new Date().toISOString()
  });
  save(); toast('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å "'+name+'" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','ok');
}

// ============================================================
// FB CALCULATORS
// ============================================================
function calcLike(){
  const b=G('flb'),cpm=G('flcpm'),cpl=G('flcpl'),rt=G('flr')/100;
  const imp=cpm>0?(b/cpm)*1000:0;
  const reach=imp*0.92;
  const likes=cpl>0?b/cpl:imp*rt;
  const acpl=likes>0?b/likes:0;
  SET('flri',fm(imp));SET('flrr',fm(reach));SET('flrl',fm(likes));SET('flrc',acpl>0?fc(acpl,2):'‚Äî');
}

function calcEng(){
  const b=G('feb'),cpm=G('fecpm'),cpe=G('fecpe'),rt=G('fer')/100;
  const imp=cpm>0?(b/cpm)*1000:0;
  const reach=imp*0.9;
  const eng=cpe>0?b/cpe:imp*rt;
  const acpe=eng>0?b/eng:0;
  SET('feri',fm(imp));SET('ferr',fm(reach));SET('fere',fm(eng));SET('ferc',acpe>0?fc(acpe,2):'‚Äî');
}

function calcLead(){
  const b=G('fldb'),cpm=G('fldcpm'),ctr=G('fldctr')/100,ffr=G('fldf')/100,prc=G('fldp'),cvr=G('fldcvr')/100;
  const imp=cpm>0?(b/cpm)*1000:0;
  const clk=imp*ctr;
  const leads=clk*ffr;
  const cpl=leads>0?b/leads:0;
  const sales=leads*cvr;
  const rev=sales*prc;
  const roas=b>0&&rev>0?rev/b:0;
  SET('fldri',fm(imp));SET('fldrc',fm(clk));SET('fldrl',f(leads,1));
  SET('fldra',cpl>0?fc(cpl,2):'‚Äî');SET('fldrs',f(sales,1));SET('fldrr',roas>0?fr(roas):'‚Äî');
}

function calcVid(){
  const b=G('fvb'),cpm=G('fvcpm'),r2=G('fv2')/100,rt=G('fvt')/100,cpv=G('fvcpv');
  const imp=cpm>0?(b/cpm)*1000:0;
  const v2=imp*r2;
  const thru=cpv>0?b/cpv:imp*rt;
  const acpv=thru>0?b/thru:0;
  const vr=imp>0?(thru/imp)*100:0;
  const ecpm=imp>0?(b/imp)*1000:0;
  SET('fvri',fm(imp));SET('fvr2',fm(v2));SET('fvrt',fm(thru));
  SET('fvrc',acpv>0?fc(acpv,2):'‚Äî');SET('fvrr',fp(vr,1));SET('fvre',ecpm>0?fc(ecpm,2):'‚Äî');
}

function clearFb(ids){ ids.forEach(id=>{ const e=$(id);if(e)e.value=''; }); }

function saveFb(type,nid){
  const name=GS(nid)||TMAP[type]+' '+(DB.length+1);
  let b=0,inputs={},imp=0,clk=0,con=0,cpa=0,rev=0,roas=0,ctr=0;
  if(type==='fb_page_like'){
    b=G('flb');const cpm=G('flcpm'),cpl=G('flcpl'),rt=G('flr')/100;
    imp=cpm>0?(b/cpm)*1000:0;clk=cpl>0?b/cpl:imp*rt;con=clk;cpa=clk>0?b/clk:0;ctr=imp>0?(clk/imp)*100:0;
    inputs={budget:b,cpm,cpl,likeRate:rt*100};
  } else if(type==='fb_engagement'){
    b=G('feb');const cpm=G('fecpm'),cpe=G('fecpe'),rt=G('fer')/100;
    imp=cpm>0?(b/cpm)*1000:0;clk=cpe>0?b/cpe:imp*rt;con=clk;cpa=clk>0?b/clk:0;ctr=imp>0?(clk/imp)*100:0;
    inputs={budget:b,cpm,cpe,engRate:rt*100};
  } else if(type==='fb_lead'){
    b=G('fldb');const cpm=G('fldcpm'),ctrR=G('fldctr')/100,ffr=G('fldf')/100,prc=G('fldp'),cvr=G('fldcvr')/100;
    imp=cpm>0?(b/cpm)*1000:0;clk=imp*ctrR;con=clk*ffr;cpa=con>0?b/con:0;
    const sales=con*cvr;rev=sales*prc;roas=b>0&&rev>0?rev/b:0;ctr=imp>0?(clk/imp)*100:0;
    inputs={budget:b,cpm,ctr:ctrR*100,formFillRate:ffr*100,productPrice:prc,cvr:cvr*100};
  } else if(type==='fb_video'){
    b=G('fvb');const cpm=G('fvcpm'),r2=G('fv2')/100,rt=G('fvt')/100,cpv=G('fvcpv');
    imp=cpm>0?(b/cpm)*1000:0;clk=cpv>0?b/cpv:imp*rt;con=clk;cpa=clk>0?b/clk:0;ctr=imp>0?(clk/imp)*100:0;
    inputs={budget:b,cpm,cpv,view2s:r2*100,thruRate:rt*100};
  }
  if(!b){ toast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Budget','warn'); return; }
  DB.push({
    id:uid(),name,type,inputs,
    results:{imp,clk,con,cpa,rev,roas,ctr},
    kpi:{tBudget:b,tImp:0,tClk:0,tCon:0,tROAS:0,tCPA:0},
    actual:{budget:0,imp:0,clk:0,con:0,rev:0},
    at:new Date().toISOString()
  });
  save(); toast('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å "'+name+'"','ok');
}

// ============================================================
// CAMPAIGNS
// ============================================================
function agg(){ return DB.reduce((a,c)=>({budget:a.budget+(c.inputs.budget||0),rev:a.rev+(c.results.rev||0),imp:a.imp+(c.results.imp||0),clk:a.clk+(c.results.clk||0),con:a.con+(c.results.con||0)}),{budget:0,rev:0,imp:0,clk:0,con:0}); }

function renderCamps(){
  const empty=$('ce'),cont=$('cc');
  if(DB.length===0){ empty.style.display='block';cont.style.display='none'; return; }
  empty.style.display='none';cont.style.display='block';
  const tot=agg();
  const cs=$('cs2');
  if(cs) cs.innerHTML=`
    <div class="mc mc-bg-b"><div class="mc-lbl">üíº Total Budget</div><div class="mc-v b">${fc(tot.budget)}</div><div class="mc-sub">${DB.length} campaigns</div></div>
    <div class="mc mc-bg-g"><div class="mc-lbl">üì¶ Total Revenue</div><div class="mc-v g">${tot.rev>0?fc(tot.rev):'‚Äî'}</div><div class="mc-sub">Expected</div></div>
    <div class="mc mc-bg-a"><div class="mc-lbl">üìà Blended ROAS</div><div class="mc-v a">${tot.rev>0?fr(tot.rev/tot.budget):'‚Äî'}</div><div class="mc-sub">All campaigns</div></div>
    <div class="mc mc-bg-v"><div class="mc-lbl">üéØ Conversions</div><div class="mc-v v">${f(tot.con,1)}</div><div class="mc-sub">Estimated total</div></div>
  `;
  $('ccount').textContent=DB.length+' campaign'+(DB.length>1?'s':'');
  const tb=$('ctbl');
  if(tb) tb.innerHTML=DB.map(c=>`
    <tr>
      <td><div class="tn">${esc(c.name)}</div><div class="tnm">${new Date(c.at).toLocaleDateString('th-TH')}</div></td>
      <td><span class="bdg ${TBDG[c.type]}">${TMAP[c.type]}</span></td>
      <td class="tv">${fc(c.inputs.budget)}</td>
      <td class="tv">${fm(c.results.imp)}</td>
      <td class="tv">${fm(c.results.clk)}</td>
      <td class="tv">${c.results.ctr>0?fp(c.results.ctr,2):'‚Äî'}</td>
      <td class="tv">${f(c.results.con,1)}</td>
      <td class="tv">${c.inputs.cvr>0?fp(c.inputs.cvr,1):c.inputs.formFillRate>0?fp(c.inputs.formFillRate,1):'‚Äî'}</td>
      <td class="tv">${c.results.cpa>0?fc(c.results.cpa,2):'‚Äî'}</td>
      <td class="tv">${c.results.rev>0?fc(c.results.rev):'‚Äî'}</td>
      <td class="tv">${c.results.roas>0?fr(c.results.roas):'‚Äî'}</td>
      <td><div class="brow" style="gap:6px">
        <button class="btn btn-ol btn-sm" onclick="loadCamp('${c.id}')">üìù</button>
        <button class="btn btn-bad btn-sm" onclick="delCamp('${c.id}')">üóëÔ∏è</button>
      </div></td>
    </tr>
  `).join('');
}

function loadCamp(id){
  const c=DB.find(x=>x.id===id);
  if(!c||c.type!=='media_buying'){ toast('‚ÑπÔ∏è Load ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Media Buying','warn'); return; }
  $('cn').value=c.name;$('cb2').value=c.inputs.budget||'';$('ccpm').value=c.inputs.cpm||'';
  $('ccpc').value=c.inputs.cpc||'';$('ccvr').value=c.inputs.cvr||'';$('cprc').value=c.inputs.productPrice||'';
  calcM(); goTab('calc'); toast('üìù ‡πÇ‡∏´‡∏•‡∏î "'+c.name+'"','ok');
}

function delCamp(id){
  if(!confirm('‡∏•‡∏ö‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏ô‡∏µ‡πâ?')) return;
  DB=DB.filter(c=>c.id!==id); save(); renderCamps(); toast('üóëÔ∏è ‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß','warn');
}

function clearAll(){
  if(DB.length===0){ toast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','warn'); return; }
  if(!confirm('‡∏•‡∏ö‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î '+DB.length+' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£?')) return;
  DB=[]; save(); renderCamps(); toast('üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß','warn');
}

// ============================================================
// CSV EXPORT
// ============================================================
function exportCSV(){
  if(!DB.length){ toast('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','warn'); return; }
  const H=['Campaign Name','Type','Date','Budget (THB)','CPM','CPC','CVR (%)','Product Price (THB)',
    'Impressions','Clicks','CTR (%)','Conversions','CPA (THB)','Revenue (THB)','ROAS',
    'KPI Target Budget','KPI Target Impressions','KPI Target Clicks','KPI Target Conversions','KPI Target ROAS','KPI Target CPA',
    'Actual Budget Spent','Actual Impressions','Actual Clicks','Actual Conversions','Actual Revenue',
    'Actual ROAS (calc)','Actual CPA (calc)'];
  const rows=DB.map(c=>{
    const aROAS=c.actual.budget>0&&c.actual.rev>0?c.actual.rev/c.actual.budget:0;
    const aCPA=c.actual.budget>0&&c.actual.con>0?c.actual.budget/c.actual.con:0;
    return ['"'+c.name.replace(/"/g,'""')+'"',TMAP[c.type],new Date(c.at).toLocaleDateString('th-TH'),
      c.inputs.budget||0,c.inputs.cpm||0,c.inputs.cpc||0,c.inputs.cvr||0,c.inputs.productPrice||0,
      Math.round(c.results.imp||0),Math.round(c.results.clk||0),(c.results.ctr||0).toFixed(3),
      (c.results.con||0).toFixed(2),(c.results.cpa||0).toFixed(2),(c.results.rev||0).toFixed(2),(c.results.roas||0).toFixed(2),
      c.kpi.tBudget||0,c.kpi.tImp||0,c.kpi.tClk||0,c.kpi.tCon||0,c.kpi.tROAS||0,c.kpi.tCPA||0,
      c.actual.budget||0,c.actual.imp||0,c.actual.clk||0,c.actual.con||0,c.actual.rev||0,
      aROAS.toFixed(2),aCPA.toFixed(2)];
  });
  const csv=[H,...rows].map(r=>r.join(',')).join('\n');
  const blob=new Blob(['\ufeff'+csv],{type:'text/csv;charset=utf-8;'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;a.download='admetrics_'+new Date().toISOString().slice(0,10)+'.csv';a.click();
  URL.revokeObjectURL(url); toast('üì• Export CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!','ok');
}

// ============================================================
// KPI TRACKING
// ============================================================
function renderKPI(){
  const em=$('ke'),ct=$('kc');
  if(!DB.length){ em.style.display='block';ct.innerHTML=''; return; }
  em.style.display='none';
  ct.innerHTML=DB.map(c=>buildKPICard(c)).join('');
  DB.forEach(c=>refreshKPI(c.id));
}

function buildKPICard(c){
  const mi=(metric,label,icon,proj)=>`
    <div class="kmi">
      <div class="kmit">${icon} ${label}</div>
      <div class="kmi-g">
        <div class="fg"><label class="fl">Target</label>
          <input class="fi" id="kt-${c.id}-${metric}" type="number" min="0"
            value="${c.kpi['t'+cap(metric)]||''}" placeholder="${f(proj,metric==='roas'?2:0)}"
            oninput="refreshKPI('${c.id}')">
        </div>
        <div class="fg"><label class="fl">Actual</label>
          <input class="fi" id="ka-${c.id}-${metric}" type="number" min="0"
            value="${c.actual[metric]||''}" placeholder="0"
            oninput="refreshKPI('${c.id}')">
        </div>
      </div>
      <div id="kp-${c.id}-${metric}"></div>
    </div>
  `;
  return `
    <div class="kpic" id="kpic-${c.id}">
      <div class="kpih">
        <div>
          <div class="kpin">${esc(c.name)}</div>
          <div class="kpim">
            <span class="bdg bdg-gr" style="background:rgba(255,255,255,.15);color:#fff">${TMAP[c.type]}</span>
            &nbsp; Budget: ${fc(c.inputs.budget)} &nbsp;|&nbsp; ${new Date(c.at).toLocaleDateString('th-TH')}
          </div>
        </div>
        <button class="btn btn-sm" style="background:rgba(255,255,255,.18);color:#fff;border:1px solid rgba(255,255,255,.25)" onclick="saveKPI('${c.id}')">üíæ Save KPI</button>
      </div>
      <div class="kpib">
        <!-- Budget -->
        <div style="background:var(--bg);border:1px solid var(--b1);border-radius:var(--r);padding:15px;margin-bottom:15px">
          <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);margin-bottom:11px">üí∞ Budget Tracking</div>
          <div class="g2" style="gap:10px;margin-bottom:10px">
            <div class="fg" style="margin:0"><label class="fl">Target Budget</label>
              <div class="iw p"><span class="ipre">‡∏ø</span>
              <input class="fi" id="kt-${c.id}-budget" type="number" min="0"
                value="${c.kpi.tBudget||''}" placeholder="${c.inputs.budget}" oninput="refreshKPI('${c.id}')">
              </div>
            </div>
            <div class="fg" style="margin:0"><label class="fl">Actual Spent</label>
              <div class="iw p"><span class="ipre">‡∏ø</span>
              <input class="fi" id="ka-${c.id}-budget" type="number" min="0"
                value="${c.actual.budget||''}" placeholder="0" oninput="refreshKPI('${c.id}')">
              </div>
            </div>
          </div>
          <div id="kp-${c.id}-budget"></div>
        </div>
        <!-- Metrics -->
        <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);margin-bottom:11px">üéØ Performance KPIs</div>
        <div class="g3" style="gap:11px">
          ${mi('imp','Impressions','üëÅÔ∏è',c.results.imp)}
          ${mi('clk','Clicks','üñ±Ô∏è',c.results.clk)}
          ${mi('con','Conversions','üéØ',c.results.con)}
          ${mi('roas','ROAS','üìà',c.results.roas)}
          ${mi('cpa','CPA (‚Üì better)','üí∞',c.results.cpa)}
          <div class="kmi">
            <div class="kmit">üì¶ Actual Revenue</div>
            <div class="fg" style="margin:0"><label class="fl">Revenue (‡∏ø)</label>
              <div class="iw p"><span class="ipre">‡∏ø</span>
              <input class="fi" id="ka-${c.id}-rev" type="number" min="0"
                value="${c.actual.rev||''}" placeholder="0" oninput="refreshKPI('${c.id}')">
              </div>
            </div>
            <div style="font-size:11px;color:var(--t3);margin-top:7px">Expected: <strong style="color:var(--ok)">${c.results.rev>0?fc(c.results.rev):'‚Äî'}</strong></div>
          </div>
        </div>
        <!-- Auto-Calc -->
        <div style="background:var(--bg);border:1px solid var(--b1);border-radius:var(--r);padding:13px;margin-top:14px">
          <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);margin-bottom:9px">üìê Auto Calculated from Actuals</div>
          <div class="g3" style="gap:8px">
            <div style="text-align:center"><div style="font-size:9px;color:var(--t3);font-weight:700;text-transform:uppercase;margin-bottom:3px">Actual ROAS</div><div id="kac-${c.id}-roas" style="font-size:17px;font-weight:800;color:var(--p)">‚Äî</div></div>
            <div style="text-align:center"><div style="font-size:9px;color:var(--t3);font-weight:700;text-transform:uppercase;margin-bottom:3px">Actual CPA</div><div id="kac-${c.id}-cpa" style="font-size:17px;font-weight:800;color:var(--warn)">‚Äî</div></div>
            <div style="text-align:center"><div style="font-size:9px;color:var(--t3);font-weight:700;text-transform:uppercase;margin-bottom:3px">Profit / Loss</div><div id="kac-${c.id}-pro" style="font-size:17px;font-weight:800">‚Äî</div></div>
          </div>
        </div>
        <div id="kovr-${c.id}"></div>
      </div>
    </div>
  `;
}

function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }

function refreshKPI(id){
  // Budget progress
  const tB=parseFloat($(`kt-${id}-budget`)?.value)||0;
  const aB=parseFloat($(`ka-${id}-budget`)?.value)||0;
  const bp=$(`kp-${id}-budget`);
  if(bp){
    if(!tB){ bp.innerHTML='<div style="font-size:10px;color:var(--t3)">‡∏Å‡∏£‡∏≠‡∏Å Target Budget</div>'; }
    else {
      const pct=aB>0?(aB/tB)*100:0;
      const cl=pct<=90?'g':pct<=100?'a':'r';
      bp.innerHTML=`<div class="prw"><div class="pri"><div class="prl">${fc(aB)} / ${fc(tB)}</div><div class="prp">${f(pct,1)}%</div></div><div class="prt"><div class="prf ${cl}" style="width:${Math.min(pct,100)}%"></div></div><div class="prs">${pct>100?'üî¥ Over Budget':pct>=90?'üü° Near Limit':'üü¢ On Budget'}</div></div>`;
    }
  }

  // Metrics
  const metrics=[{k:'imp',lower:false},{k:'clk',lower:false},{k:'con',lower:false},{k:'roas',lower:false},{k:'cpa',lower:true}];
  let scores=[];
  metrics.forEach(m=>{
    const tEl=$(`kt-${id}-${m.k}`);
    const aEl=$(`ka-${id}-${m.k}`);
    const pEl=$(`kp-${id}-${m.k}`);
    if(!tEl||!aEl||!pEl) return;
    let target=parseFloat(tEl.value)||0;
    let actual=parseFloat(aEl.value)||0;
    // Auto-calc ROAS & CPA from revenue/budget/conv if input is empty
    if(m.k==='roas'&&actual===0){
      const ab=parseFloat($(`ka-${id}-budget`)?.value)||0;
      const ar=parseFloat($(`ka-${id}-rev`)?.value)||0;
      if(ab>0&&ar>0) actual=ar/ab;
    }
    if(m.k==='cpa'&&actual===0){
      const ab=parseFloat($(`ka-${id}-budget`)?.value)||0;
      const ac=parseFloat($(`ka-${id}-con`)?.value)||0;
      if(ab>0&&ac>0) actual=ab/ac;
    }
    if(!target||!actual){ pEl.innerHTML='<div style="font-size:10px;color:var(--t3);padding:2px 0">‡∏Å‡∏£‡∏≠‡∏Å Target & Actual</div>'; return; }
    const pct=m.lower?(target/actual)*100:(actual/target)*100;
    const w=Math.min(pct,100);
    let cl,st,dot;
    if(m.lower){
      if(pct>=100){cl='g';st='‚úÖ On Target';dot='var(--ok)'}
      else if(pct>=80){cl='a';st='‚ö†Ô∏è Slightly Over';dot='var(--warn)'}
      else{cl='r';st='‚ùå Over Limit';dot='var(--bad)'}
    } else {
      if(pct>=100){cl='g';st='‚úÖ Target Met';dot='var(--ok)'}
      else if(pct>=75){cl='a';st='‚ö° On Track';dot='var(--warn)'}
      else{cl='r';st='‚ùå Behind Target';dot='var(--bad)'}
    }
    scores.push({pct,ok:pct>=75});
    pEl.innerHTML=`<div class="prw"><div class="pri"><div class="prp" style="color:${dot}">${f(pct,1)}% to KPI</div><div style="font-size:10px;color:var(--t3)">${st}</div></div><div class="prt"><div class="prf ${cl}" style="width:${w}%"></div></div></div>`;
  });

  // Auto-calc display
  const aREV=parseFloat($(`ka-${id}-rev`)?.value)||0;
  const aROAS=aB>0&&aREV>0?aREV/aB:0;
  const aCON=parseFloat($(`ka-${id}-con`)?.value)||0;
  const aCPA=aB>0&&aCON>0?aB/aCON:0;
  const aProfit=aREV-aB;
  const re=$(`kac-${id}-roas`);const ce=$(`kac-${id}-cpa`);const pe=$(`kac-${id}-pro`);
  if(re){ re.textContent=aROAS>0?fr(aROAS):'‚Äî'; re.style.color=aROAS>=3?'var(--ok)':aROAS>0?'var(--warn)':'var(--t3)'; }
  if(ce) ce.textContent=aCPA>0?fc(aCPA,2):'‚Äî';
  if(pe){ pe.textContent=aB>0&&aREV>0?fc(Math.abs(aProfit))+(aProfit<0?' üî¥':' üü¢'):'‚Äî'; pe.style.color=aProfit>0?'var(--ok)':aProfit<0?'var(--bad)':'var(--t3)'; }

  // Overall summary
  const oEl=$(`kovr-${id}`);
  if(oEl&&scores.length){
    const on=scores.filter(s=>s.ok).length;
    const pct=Math.round((on/scores.length)*100);
    const cls=pct>=75?'ok':pct>=50?'warn':'bad';
    const icon=pct>=75?'‚úÖ':pct>=50?'‚ö†Ô∏è':'‚ùå';
    oEl.innerHTML=`<div class="kpiovr ${cls}"><div class="kpotr">${icon} KPI Achievement: ${on}/${scores.length} metrics on track (${pct}%)</div><button class="btn btn-sm btn-p" onclick="saveKPI('${id}')">üíæ Save Progress</button></div>`;
  }
}

function saveKPI(id){
  const c=DB.find(x=>x.id===id); if(!c) return;
  const metrics=['imp','clk','con','roas','cpa'];
  c.kpi.tBudget=parseFloat($(`kt-${id}-budget`)?.value)||0;
  c.actual.budget=parseFloat($(`ka-${id}-budget`)?.value)||0;
  metrics.forEach(m=>{
    c.kpi['t'+cap(m)]=parseFloat($(`kt-${id}-${m}`)?.value)||0;
    c.actual[m]=parseFloat($(`ka-${id}-${m}`)?.value)||0;
  });
  c.actual.rev=parseFloat($(`ka-${id}-rev`)?.value)||0;
  save(); toast('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å KPI "'+c.name+'"','ok');
}

// ============================================================
// DASHBOARD
// ============================================================
function renderDash(){
  const em=$('de'),ct=$('dc');
  if(!DB.length){ em.style.display='block';ct.style.display='none'; return; }
  em.style.display='none';ct.style.display='block';

  const tot=agg();
  const avgROAS=tot.budget>0&&tot.rev>0?tot.rev/tot.budget:0;
  const avgCTR=tot.imp>0?(tot.clk/tot.imp)*100:0;

  const strip=$('dstrip');
  if(strip) strip.innerHTML=`
    <div class="ssi"><div class="ssv">${fc(tot.budget)}</div><div class="ssk">Total Budget</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${tot.rev>0?fc(tot.rev):'‚Äî'}</div><div class="ssk">Total Revenue</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${avgROAS>0?fr(avgROAS):'‚Äî'}</div><div class="ssk">Blended ROAS</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${fm(tot.imp)}</div><div class="ssk">Total Impressions</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${fm(tot.clk)}</div><div class="ssk">Total Clicks</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${f(tot.con,1)}</div><div class="ssk">Total Conversions</div></div>
    <div class="ssdv"></div>
    <div class="ssi"><div class="ssv">${fp(avgCTR,2)}</div><div class="ssk">Avg CTR</div></div>
  `;

  Object.values(CHARTS).forEach(ch=>{ try{ch.destroy();}catch(e){} });
  CHARTS={};

  const labels=DB.map(c=>c.name.length>14?c.name.slice(0,14)+'‚Ä¶':c.name);
  const opts={responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}};

  // Budget
  const c1=$('ch1');
  if(c1) CHARTS.c1=new Chart(c1,{type:'bar',data:{labels,datasets:[{label:'Budget',data:DB.map(c=>c.inputs.budget||0),backgroundColor:COLORS.slice(0,DB.length),borderRadius:7,borderWidth:0}]},options:{...opts,plugins:{legend:{display:false}},scales:{y:{ticks:{callback:v=>'‡∏ø'+(v>=1000?(v/1000).toFixed(0)+'K':v)},grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  // ROAS
  const c2=$('ch2');
  if(c2) CHARTS.c2=new Chart(c2,{type:'bar',data:{labels,datasets:[{label:'ROAS',data:DB.map(c=>c.results.roas||0),backgroundColor:DB.map(c=>(c.results.roas||0)>=3?'rgba(5,150,105,.8)':(c.results.roas||0)>=1?'rgba(217,119,6,.8)':'rgba(220,38,38,.8)'),borderRadius:7,borderWidth:0},{label:'Target 3x',data:DB.map(()=>3),type:'line',borderColor:'#EF4444',borderDash:[5,4],borderWidth:2,pointRadius:0,fill:false}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{font:{size:11}}}},scales:{y:{ticks:{callback:v=>v+'x'},beginAtZero:true,grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  // Impr vs Clicks
  const c3=$('ch3');
  if(c3) CHARTS.c3=new Chart(c3,{type:'bar',data:{labels,datasets:[{label:'Impressions',data:DB.map(c=>c.results.imp||0),backgroundColor:'rgba(59,130,246,.75)',borderRadius:5,borderWidth:0},{label:'Clicks',data:DB.map(c=>c.results.clk||0),backgroundColor:'rgba(16,185,129,.75)',borderRadius:5,borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{font:{size:11}}}},scales:{y:{ticks:{callback:v=>v>=1000?(v/1000).toFixed(0)+'K':v},grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  // CPA vs Price
  const c4=$('ch4');
  if(c4) CHARTS.c4=new Chart(c4,{type:'bar',data:{labels,datasets:[{label:'CPA (‡∏ø)',data:DB.map(c=>c.results.cpa||0),backgroundColor:'rgba(220,38,38,.7)',borderRadius:5,borderWidth:0},{label:'Product Price (‡∏ø)',data:DB.map(c=>c.inputs.productPrice||0),backgroundColor:'rgba(99,102,241,.7)',borderRadius:5,borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{font:{size:11}}}},scales:{y:{ticks:{callback:v=>'‡∏ø'+v},grid:{color:'#F1F5F9'}},x:{grid:{display:false}}}}});

  // Campaign Type
  const c5=$('ch5');
  if(c5){
    const tc={};DB.forEach(c=>{ tc[c.type]=(tc[c.type]||0)+1; });
    CHARTS.c5=new Chart(c5,{type:'doughnut',data:{labels:Object.keys(tc).map(t=>TMAP[t]),datasets:[{data:Object.values(tc),backgroundColor:['#3B82F6','#10B981','#F59E0B','#8B5CF6','#EF4444'],borderWidth:2,borderColor:'#fff'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{font:{size:11},padding:14}}},cutout:'62%'}});
  }

  // KPI Summary in dash
  const kd=$('kdash'),kdb=$('kdashb');
  const withKPI=DB.filter(c=>c.kpi.tCon>0||c.kpi.tImp>0||c.kpi.tROAS>0);
  if(kd&&kdb){
    if(withKPI.length){
      kd.style.display='block';
      kdb.innerHTML=`<div class="g3" style="gap:12px">
        ${withKPI.map(c=>{
          const metrics=[{k:'con',label:'Conversions',t:c.kpi.tCon,a:c.actual.con,lower:false},{k:'roas',label:'ROAS',t:c.kpi.tROAS,a:c.actual.roas,lower:false},{k:'cpa',label:'CPA',t:c.kpi.tCPA,a:c.actual.cpa,lower:true}].filter(m=>m.t>0&&m.a>0);
          if(!metrics.length) return '';
          const scores=metrics.map(m=>m.lower?(m.t/m.a)>=1:(m.a/m.t)>=0.75);
          const onTrack=scores.filter(Boolean).length;
          const pct=Math.round((onTrack/scores.length)*100);
          const cl=pct>=75?'ok':pct>=50?'warn':'bad';
          const bgCl=pct>=75?'var(--okl)':pct>=50?'var(--warnl)':'var(--badl)';
          const bdr=pct>=75?'#A7F3D0':pct>=50?'#FDE68A':'#FECACA';
          const tcl=pct>=75?'var(--ok)':pct>=50?'var(--warn)':'var(--bad)';
          return `<div style="background:${bgCl};border:1px solid ${bdr};border-radius:var(--r);padding:14px">
            <div style="font-weight:700;font-size:13px;margin-bottom:6px">${esc(c.name)}</div>
            ${metrics.map(m=>{
              const p=m.lower?(m.t/m.a)*100:(m.a/m.t)*100;
              return `<div style="margin-bottom:5px"><div style="font-size:10px;color:var(--t3);margin-bottom:3px">${m.label}</div><div class="prt"><div class="prf g" style="width:${Math.min(p,100)}%"></div></div><div style="font-size:10px;color:var(--t3)">${f(p,1)}%</div></div>`;
            }).join('')}
            <div style="font-size:12px;font-weight:700;color:${tcl};margin-top:8px">${onTrack}/${scores.length} KPIs on track (${pct}%)</div>
          </div>`;
        }).join('')}
      </div>`;
    } else { kd.style.display='none'; }
  }
}

// ============================================================
// HEADER & BADGE
// ============================================================
function refreshHeader(){
  const tot=agg();
  const roas=tot.budget>0&&tot.rev>0?tot.rev/tot.budget:0;
  const h1=$('hs1'),h2=$('hs2'),h3=$('hs3'),h4=$('hs4');
  if(h1) h1.textContent=DB.length;
  if(h2) h2.textContent=tot.budget>=1e6?'‡∏ø'+f(tot.budget/1e6,1)+'M':tot.budget>=1000?'‡∏ø'+f(tot.budget/1000,1)+'K':fc(tot.budget);
  if(h3) h3.textContent=roas>0?fr(roas):'‚Äî';
  if(h4) h4.textContent=f(tot.con,1);
}
function refreshBadge(){ const nb=$('nc'); if(nb) nb.textContent=DB.length; }

// ============================================================
// TOAST
// ============================================================
function toast(msg,type='ok'){
  let box=$('toasts');
  if(!box){ box=document.createElement('div');box.id='toasts';document.body.appendChild(box); }
  const t=document.createElement('div');
  t.className='tst '+type;t.textContent=msg;
  box.appendChild(t);
  setTimeout(()=>{ t.style.cssText+='opacity:0;transform:translateX(16px);transition:all .25s'; setTimeout(()=>t.remove(),260); },2800);
}

// ============================================================
// INIT
// ============================================================
refreshHeader(); refreshBadge();
</script>
</body>
</html>
```

---

## ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚úÖ

<details>
<summary><strong>üìã ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ</strong></summary>

| Tab | ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå |
|-----|---------|
| üßÆ **Media Buying** | ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Budget, CPM, CPC, CVR, Product Price ‚Üí Impressions, Clicks, Conversions, CPA, ROAS, Profit, CTR, eCPM |
| üìò **Facebook Ads** | Page Like / Engagement / Lead Ads / Video View ‚Äî ‡πÅ‡∏¢‡∏Å Objective ‡∏Ñ‡∏£‡∏ö |
| üìã **Campaigns** | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å + ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ó‡∏∏‡∏Å‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç, Export CSV ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå |
| üéØ **KPI Tracking** | Target vs Actual ‡∏ó‡∏∏‡∏Å metric, Progress bar, Auto-calc ROAS/CPA, Overall score |
| üìà **Dashboard** | Chart 5 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó, Summary strip, KPI Achievement overview |

</details>

- **Light theme** ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞ B2B presentation
- **Responsive** ‡∏ó‡∏∏‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
- **Local Storage** ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠ refresh
